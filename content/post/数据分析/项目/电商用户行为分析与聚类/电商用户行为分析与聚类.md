---
title: "ç”µå•†ç”¨æˆ·è¡Œä¸ºåˆ†æä¸èšç±»"
date: 2025-03-09
categories: ["é¡¹ç›®"]
tags: ["æ•°æ®åˆ†æ", "ç”¨æˆ·åˆ†æ", "èšç±»ç®—æ³•", "å¯è§†åŒ–"]
summary: "åŸºäº1000æ¡ç”µå•†ç”¨æˆ·æ•°æ®ï¼Œè¿ç”¨RFMæ¨¡å‹å’ŒK-Meansèšç±»ç®—æ³•è¿›è¡Œç”¨æˆ·ä»·å€¼åˆ†ç¾¤ï¼›æ·±åº¦å‰–æç”¨æˆ·ç”»åƒã€æ´»è·ƒåº¦å’Œæ¶ˆè´¹è¡Œä¸ºï¼Œä¸ºä¸åŒç”¨æˆ·ç¾¤ä½“åˆ¶å®šå·®å¼‚åŒ–è¥é”€ç­–ç•¥ï¼ŒåŠ©åŠ›ç²¾å‡†è¿è¥"
math: true
---

# 1. èƒŒæ™¯æè¿°

æœ¬æ•°æ®é›†æ±‡é›†äº†æŸä¸ªç”µå•†å¹³å°çš„ç”¨æˆ·åŸºæœ¬ä¿¡æ¯ã€è¡Œä¸ºä¹ æƒ¯å’Œäº’åŠ¨æ•°æ®ã€‚å®ƒåŒ…æ‹¬ç”¨æˆ·çš„å¹´é¾„ã€æ€§åˆ«ã€å±…ä½åœ°åŒºã€æ”¶å…¥æ°´å¹³ç­‰åŸºæœ¬å±æ€§ï¼Œä»¥åŠä»–ä»¬çš„å…´è¶£åå¥½ã€ç™»å½•é¢‘ç‡ã€è´­ä¹°è¡Œä¸ºå’Œå¹³å°äº’åŠ¨ç­‰åŠ¨æ€æŒ‡æ ‡ã€‚
 
æ•°æ®é›†å…³æ³¨çš„ç„¦ç‚¹åœ¨äºç”µå•†é¢†åŸŸï¼Œæ—¨åœ¨é€šè¿‡ç”¨æˆ·è¡Œä¸ºçš„æ·±å…¥åˆ†æï¼Œæ­ç¤ºå…¶åå¥½å’Œéœ€æ±‚ã€‚é€šè¿‡è¿™äº›æ•°æ®ï¼Œå•†å®¶èƒ½å¤Ÿæ›´å¥½åœ°ç†è§£æ¶ˆè´¹è€…ï¼Œåˆ¶å®šæœ‰æ•ˆçš„å¸‚åœºç­–ç•¥ï¼Œæ»¡è¶³ç”¨æˆ·æœŸæœ›ï¼Œæ¨åŠ¨ä¸šåŠ¡å‘å±•ã€‚

# 2. æ•°æ®è¯´æ˜

| å­—æ®µ | è¯´æ˜ | ç±»å‹ |
|:------|:------|:------|
| User_ID | æ¯ä¸ªç”¨æˆ·çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œä¾¿äºè¿½è¸ªå’Œåˆ†æ | æ–‡æœ¬ |
| Age | ç”¨æˆ·çš„å¹´é¾„ï¼Œæä¾›å¯¹äººå£ç»Ÿè®¡åå¥½çš„æ´å¯Ÿ | æ•°å€¼ |
| Gender | ç”¨æˆ·çš„æ€§åˆ«ï¼Œä½¿èƒ½æ€§åˆ«ç‰¹å®šçš„æ¨èå’Œå®šä½ | åˆ†ç±» |
| Location | ç”¨æˆ·æ‰€åœ¨åœ°åŒºï¼šéƒŠåŒºã€å†œæ‘ã€åŸå¸‚ï¼Œå½±å“åå¥½å’Œè´­ç‰©ä¹ æƒ¯ | åˆ†ç±» |
| Income | ç”¨æˆ·çš„æ”¶å…¥æ°´å¹³ï¼Œè¡¨æ˜è´­ä¹°åŠ›å’Œæ”¯ä»˜èƒ½åŠ› | æ•°å€¼ |
| Interests | ç”¨æˆ·çš„å…´è¶£ï¼Œå¦‚è¿åŠ¨ã€æ—¶å°šã€æŠ€æœ¯ç­‰ï¼ŒæŒ‡å¯¼å†…å®¹å’Œäº§å“æ¨è | åˆ†ç±» |
| Last_Login_Days_Ago | ç”¨æˆ·ä¸Šæ¬¡ç™»å½•ä»¥æ¥çš„å¤©æ•°ï¼Œåæ˜ å‚ä¸é¢‘ç‡ | æ•°å€¼ |
| Purchase_Frequency | ç”¨æˆ·è¿›è¡Œè´­ä¹°çš„é¢‘ç‡ï¼Œè¡¨æ˜è´­ç‰©ä¹ æƒ¯å’Œå¿ è¯šåº¦ | æ•°å€¼ |
| Average_Order_Value | ç”¨æˆ·ä¸‹å•çš„å¹³å‡ä»·å€¼ï¼Œå¯¹å®šä»·å’Œä¿ƒé”€ç­–ç•¥è‡³å…³é‡è¦ | æ•°å€¼ |
| Total_Spending | ç”¨æˆ·æ¶ˆè´¹çš„æ€»é‡‘é¢ï¼Œè¡¨æ˜ç»ˆèº«ä»·å€¼å’Œè´­ä¹°è¡Œä¸º | æ•°å€¼ |
| Product_Category_Preference | ç”¨æˆ·åå¥½çš„ç‰¹å®šäº§å“ç±»åˆ« | åˆ†ç±» |
| Time_Spent_on_Site_Minutes | ç”¨æˆ·åœ¨ç”µå­å•†åŠ¡å¹³å°ä¸ŠèŠ±è´¹çš„æ—¶é—´ï¼Œè¡¨æ˜å‚ä¸ç¨‹åº¦ | æ•°å€¼ |
| Pages_Viewed | ç”¨æˆ·åœ¨è®¿é—®æœŸé—´æµè§ˆçš„é¡µé¢æ•°é‡ï¼Œåæ˜ æµè§ˆæ´»åŠ¨å’Œå…´è¶£ | æ•°å€¼ |
| Newsletter_Subscription | ç”¨æˆ·æ˜¯å¦è®¢é˜…äº†è¥é”€æ´»åŠ¨é€šçŸ¥ | å¸ƒå°” |

# 3. é—®é¢˜æè¿°

æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡æ•°æ®åˆ†æå’Œæœºå™¨å­¦ä¹ æ–¹æ³•ï¼Œè§£å†³ä»¥ä¸‹æ ¸å¿ƒé—®é¢˜ã€‚

## 3.1 åˆ†æç›®æ ‡

- **ç”¨æˆ·ç”»åƒåˆ†æ**ï¼šæ·±å…¥äº†è§£ä¸åŒç”¨æˆ·ç¾¤ä½“çš„ç‰¹å¾
- **ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ**ï¼šè¯†åˆ«é«˜ä»·å€¼å’Œä½æ´»è·ƒç”¨æˆ·
- **ç”¨æˆ·ä»·å€¼åˆ†ç¾¤**ï¼šåŸºäºRFMæ¨¡å‹å’Œæœºå™¨å­¦ä¹ ç®—æ³•è¿›è¡Œç²¾å‡†åˆ†ç¾¤
- **å•†ä¸šç­–ç•¥å»ºè®®**ï¼šä¸ºä¸åŒç”¨æˆ·ç¾¤ä½“åˆ¶å®šå·®å¼‚åŒ–è¥é”€ç­–ç•¥

## 3.2 æ ¸å¿ƒé—®é¢˜

1. **ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ**ï¼šä¸åŒç”¨æˆ·ç¾¤ä½“çš„æ´»è·ƒç¨‹åº¦å¦‚ä½•ï¼Ÿå“ªäº›å› ç´ å½±å“ç”¨æˆ·æ´»è·ƒåº¦ï¼Ÿ
2. **ç”¨æˆ·ä»·å€¼åˆ†ç¾¤**ï¼šå¦‚ä½•ç§‘å­¦åœ°å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç¾¤ï¼Œè¯†åˆ«é«˜ä»·å€¼ç”¨æˆ·ï¼Ÿ
3. **ç²¾å‡†è¥é”€ç­–ç•¥**ï¼šé’ˆå¯¹ä¸åŒç”¨æˆ·ç¾¤ä½“ï¼Œåº”è¯¥åˆ¶å®šæ€æ ·çš„å·®å¼‚åŒ–è¥é”€ç­–ç•¥ï¼Ÿ

## 3.3 åˆ†ææ–¹æ³•

- **æè¿°æ€§ç»Ÿè®¡åˆ†æ**ï¼šäº†è§£æ•°æ®æ•´ä½“åˆ†å¸ƒç‰¹å¾
- **RFMæ¨¡å‹åˆ†æ**ï¼šåŸºäºæœ€è¿‘æ¶ˆè´¹ã€é¢‘ç‡ã€é‡‘é¢è¿›è¡Œç”¨æˆ·ä»·å€¼åˆ†ç±»
- **K-Meansèšç±»ç®—æ³•**ï¼šä½¿ç”¨æœºå™¨å­¦ä¹ æ–¹æ³•è¿›è¡Œç”¨æˆ·åˆ†ç¾¤
- **å¯è§†åŒ–åˆ†æ**ï¼šä½¿ç”¨pyechartsè¿›è¡Œä¸“ä¸šçš„æ•°æ®å¯è§†åŒ–

# 4. æ•°æ®æ¸…æ´—åŠé¢„è§ˆ

åœ¨è¿›è¡Œæ•°æ®åˆ†æä¹‹å‰ï¼Œé¦–å…ˆéœ€è¦å¯¹æ•°æ®è¿›è¡Œæ¸…æ´—å’Œé¢„è§ˆï¼Œç¡®ä¿æ•°æ®è´¨é‡ç¬¦åˆåˆ†æè¦æ±‚ã€‚

## 4.1 å¯¼å…¥å¿…è¦çš„åº“

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æ•°æ®å¤„ç†åº“
import pandas as pd
import numpy as np
import warnings
warnings.filterwarnings('ignore')

# å¯è§†åŒ–åº“ - pyecharts (ä½¿ç”¨ç¦»çº¿æ¨¡å¼)
from pyecharts import options as opts
from pyecharts.charts import Bar, Pie, Line, Scatter, Radar, HeatMap, Grid, Tab
from pyecharts.globals import ThemeType, CurrentConfig
from pyecharts.commons.utils import JsCode

# æœºå™¨å­¦ä¹ åº“
from sklearn.cluster import KMeans  # K-Meansèšç±»ç®—æ³•
from sklearn.preprocessing import StandardScaler, MinMaxScaler, RobustScaler  # æ•°æ®æ ‡å‡†åŒ–
from sklearn.metrics import silhouette_score, davies_bouldin_score, calinski_harabasz_score  # èšç±»è¯„ä¼°æŒ‡æ ‡
from sklearn.decomposition import PCA  # ä¸»æˆåˆ†åˆ†æé™ç»´
from sklearn.manifold import TSNE  # t-SNEé™ç»´ï¼ˆæ›´é€‚åˆå¯è§†åŒ–ï¼‰

print("æ‰€æœ‰åº“å¯¼å…¥æˆåŠŸï¼")
```
{{< /admonition >}}

## 4.2 æ•°æ®åŠ è½½ä¸è´¨é‡æ£€æŸ¥

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# è¯»å–æ•°æ®
df = pd.read_csv('user_personalized_features.csv', index_col=['Unnamed: 0'])

# æ•°æ®é¢„è§ˆ
print("="*70)
print(" æ•°æ®é¢„è§ˆï¼ˆå‰5è¡Œï¼‰")
print("="*70)
display(df.head())

# æ•°æ®ç»´åº¦
print("\n" + "="*70)
print(f"æ•°æ®é›†ç»´åº¦ï¼š{df.shape[0]} è¡Œ Ã— {df.shape[1]} åˆ—")
print("="*70)

# æ•°æ®è´¨é‡æ£€æŸ¥
print("\n" + "="*70)
print(" æ•°æ®è´¨é‡æ£€æŸ¥")
print("="*70)
print(f"âœ“ é‡å¤å€¼æ•°é‡ï¼š{df.duplicated().sum()} æ¡")
print(f"âœ“ ç¼ºå¤±å€¼æ€»æ•°ï¼š{df.isna().sum().sum()} ä¸ª")
if df.isna().sum().sum() > 0:
    print("\nå„å­—æ®µç¼ºå¤±å€¼è¯¦æƒ…ï¼š")
    print(df.isna().sum()[df.isna().sum() > 0])
    
# æ•°æ®ç±»å‹ä¿¡æ¯
print("\n" + "="*70)
print(" æ•°æ®ç±»å‹ä¿¡æ¯")
print("="*70)
display(df.info())

# æè¿°æ€§ç»Ÿè®¡
print("\n" + "="*70)
print(" æ•°å€¼å‹å­—æ®µæè¿°æ€§ç»Ÿè®¡")
print("="*70)
display(df.describe().round(2))

# åˆ†ç±»å­—æ®µç»Ÿè®¡
print("\n" + "="*70)
print("åˆ†ç±»å­—æ®µå”¯ä¸€å€¼ç»Ÿè®¡")
print("="*70)
categorical_cols = df.select_dtypes(include=['object', 'bool']).columns
for col in categorical_cols:
    if col != 'User_ID':
        print(f"\n{col}: {df[col].nunique()} ä¸ªå”¯ä¸€å€¼")
        print(f"  {df[col].unique()}")
```

```
======================================================================
 æ•°æ®é¢„è§ˆï¼ˆå‰5è¡Œï¼‰
======================================================================

======================================================================
 æ•°æ®é›†ç»´åº¦ï¼š1000 è¡Œ Ã— 14 åˆ—
======================================================================

======================================================================
 æ•°æ®è´¨é‡æ£€æŸ¥
======================================================================
âœ“ é‡å¤å€¼æ•°é‡ï¼š0 æ¡
âœ“ ç¼ºå¤±å€¼æ€»æ•°ï¼š0 ä¸ª

======================================================================
ğŸ“‹ æ•°æ®ç±»å‹ä¿¡æ¯
======================================================================
<class 'pandas.core.frame.DataFrame'>
Index: 1000 entries, 0 to 999
Data columns (total 14 columns):
 #   Column                       Non-Null Count  Dtype 
---  ------                       --------------  ----- 
 0   User_ID                      1000 non-null   object
 1   Age                          1000 non-null   int64 
 2   Gender                       1000 non-null   object
 3   Location                     1000 non-null   object
 4   Income                       1000 non-null   int64 
 5   Interests                    1000 non-null   object
 6   Last_Login_Days_Ago          1000 non-null   int64 
 7   Purchase_Frequency           1000 non-null   int64 
 8   Average_Order_Value          1000 non-null   int64 
 9   Total_Spending               1000 non-null   int64 
 10  Product_Category_Preference  1000 non-null   object
 11  Time_Spent_on_Site_Minutes   1000 non-null   int64 
 12  Pages_Viewed                 1000 non-null   int64 
 13  Newsletter_Subscription      1000 non-null   bool  
dtypes: bool(1), int64(8), object(5)
memory usage: 110.4+ KB

======================================================================
 æ•°å€¼å‹å­—æ®µæè¿°æ€§ç»Ÿè®¡
======================================================================
```
{{< /admonition >}}



## 4.3 æ•°æ®åˆ†å¸ƒè§£è¯»

###  å…³é”®æŒ‡æ ‡åˆ†æ

**Ageï¼ˆå¹´é¾„ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š18-64å²
- **å¹³å‡å¹´é¾„**ï¼š40å²
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼š29-52å²ç”¨æˆ·å 50%ï¼Œå‘ˆç°æ˜æ˜¾çš„ä¸­å¹´ç”¨æˆ·é›†ä¸­ç°è±¡
- **ä¸šåŠ¡æ„ä¹‰**ï¼šå¹³å°ä¸»è¦æœåŠ¡äºç»æµèƒ½åŠ›è¾ƒå¼ºçš„ä¸­å¹´ç¾¤ä½“

**Incomeï¼ˆæ”¶å…¥ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š20,155-149,951å…ƒ
- **å¹³å‡æ”¶å…¥**ï¼š81,305å…ƒï¼ˆä¸­ä½æ•°81,042å…ƒï¼‰
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼šæ”¶å…¥åˆ†å¸ƒå‘ˆç°æ˜æ˜¾çš„ä¸¤æåˆ†åŒ–ï¼Œä½†å¤§éƒ¨åˆ†ç”¨æˆ·é›†ä¸­åœ¨ä¸­ç­‰æ”¶å…¥æ°´å¹³
- **ä¸šåŠ¡æ„ä¹‰**ï¼šéœ€è¦é’ˆå¯¹ä¸åŒæ”¶å…¥å±‚çº§è®¾è®¡å·®å¼‚åŒ–çš„äº§å“å’Œå®šä»·ç­–ç•¥

**Last_Login_Days_Agoï¼ˆæœ€è¿‘ç™»å½•ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š1-29å¤©
- **å¹³å‡å€¼**ï¼š15.5å¤©
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼š75%ç”¨æˆ·è·ä¸Šæ¬¡ç™»å½•è¶…è¿‡8å¤©ï¼Œæ•´ä½“æ´»è·ƒåº¦æœ‰å¾…æå‡
- **ä¸šåŠ¡æ„ä¹‰**ï¼šéœ€è¦åŠ å¼ºç”¨æˆ·å¬å›å’Œæ´»è·ƒåº¦æå‡ç­–ç•¥

**Purchase_Frequencyï¼ˆè´­ä¹°é¢‘ç‡ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š0-9æ¬¡
- **å¹³å‡å€¼**ï¼š4.6æ¬¡ï¼ˆä¸­ä½æ•°5æ¬¡ï¼‰
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼š50%ç”¨æˆ·è´­ä¹°é¢‘æ¬¡â‰¥5æ¬¡ï¼Œæ˜¾ç¤ºå‡ºè¾ƒå¥½çš„å¤è´­ç‡
- **ä¸šåŠ¡æ„ä¹‰**ï¼šå­˜åœ¨ä¸€å®šçš„å¿ è¯šç”¨æˆ·åŸºç¡€ï¼Œå¯æ·±åº¦æŒ–æ˜

**Average_Order_Valueï¼ˆå¹³å‡å®¢å•ä»·ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š10-199å…ƒ
- **å¹³å‡å€¼**ï¼š104å…ƒï¼ˆä¸­ä½æ•°105å…ƒï¼‰
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼š75%è®¢å•â‰¤150å…ƒï¼Œæ•´ä½“æ¶ˆè´¹åå‘ç»æµå®æƒ 
- **ä¸šåŠ¡æ„ä¹‰**ï¼šå¯é€šè¿‡ç»„åˆè¥é”€æå‡å®¢å•ä»·

**Total_Spendingï¼ˆæ€»æ¶ˆè´¹é‡‘é¢ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š112-4,999å…ƒ
- **å¹³å‡å€¼**ï¼š2,553å…ƒ
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼šæ¶ˆè´¹é‡‘é¢åˆ†å¸ƒå‘ˆé‡‘å­—å¡”å‹ï¼Œé«˜ä»·å€¼ç”¨æˆ·å æ¯”è¾ƒå°
- **ä¸šåŠ¡æ„ä¹‰**ï¼šéœ€è¦ç²¾å‡†è¯†åˆ«å’Œç»´æŠ¤é«˜ä»·å€¼å®¢æˆ·

**Time_Spent_on_Site_Minutesï¼ˆåœç•™æ—¶é•¿ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š2-599åˆ†é’Ÿ
- **å¹³å‡å€¼**ï¼š297åˆ†é’Ÿï¼ˆçº¦5å°æ—¶ï¼‰
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼š75%ç”¨æˆ·åœç•™æ—¶é—´>144åˆ†é’Ÿï¼Œæ˜¾ç¤ºè¾ƒé«˜çš„å¹³å°ç²˜æ€§
- **ä¸šåŠ¡æ„ä¹‰**ï¼šé•¿åœç•™æ—¶é—´ä¸ºè½¬åŒ–æä¾›äº†è‰¯å¥½åŸºç¡€

**Pages_Viewedï¼ˆæµè§ˆé¡µæ•°ï¼‰**
- **åˆ†å¸ƒèŒƒå›´**ï¼š1-49é¡µ
- **å¹³å‡å€¼**ï¼š24.4é¡µ
- **æ ¸å¿ƒæ´å¯Ÿ**ï¼š75%ç”¨æˆ·æµè§ˆ>12é¡µï¼Œæ˜¾ç¤ºå‡ºè¾ƒå¼ºçš„æ¢ç´¢æ„æ„¿
- **ä¸šåŠ¡æ„ä¹‰**ï¼šå¯ä¼˜åŒ–é¡µé¢å¸ƒå±€å’Œæ¨èç®—æ³•æé«˜è½¬åŒ–ç‡

## 4.4 åˆ†ç±»å­—æ®µåˆ†æ

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æå–æ‰€æœ‰åˆ†ç±»å­—æ®µçš„å”¯ä¸€å€¼
print("="*70)
print("ğŸ“‹ åˆ†ç±»å­—æ®µè¯¦ç»†ä¿¡æ¯")
print("="*70)

categorical_features = {}
for col in df.columns:
    if df[col].dtype == 'object' and col != 'User_ID':
        unique_values = df[col].unique()
        count_values = df[col].value_counts()
        categorical_features[col] = {
            'unique_count': len(unique_values),
            'values': unique_values,
            'distribution': count_values
        }
        print(f"\nã€{col}ã€‘")
        print(f"  å”¯ä¸€å€¼æ•°é‡: {len(unique_values)}")
        print(f"  å”¯ä¸€å€¼: {unique_values}")
        print(f"  åˆ†å¸ƒæƒ…å†µ:")
        for val, cnt in count_values.items():
            print(f"    - {val}: {cnt} ({cnt/len(df)*100:.1f}%)")
```

```
======================================================================
ğŸ“‹ åˆ†ç±»å­—æ®µè¯¦ç»†ä¿¡æ¯
======================================================================

ã€Genderã€‘
  å”¯ä¸€å€¼æ•°é‡: 2
  å”¯ä¸€å€¼: ['Male' 'Female']
  åˆ†å¸ƒæƒ…å†µ:
    - Male: 526 (52.6%)
    - Female: 474 (47.4%)

ã€Locationã€‘
  å”¯ä¸€å€¼æ•°é‡: 3
  å”¯ä¸€å€¼: ['Suburban' 'Rural' 'Urban']
  åˆ†å¸ƒæƒ…å†µ:
    - Suburban: 349 (34.9%)
    - Urban: 344 (34.4%)
    - Rural: 307 (30.7%)

ã€Interestsã€‘
  å”¯ä¸€å€¼æ•°é‡: 5
  å”¯ä¸€å€¼: ['Sports' 'Technology' 'Fashion' 'Travel' 'Food']
  åˆ†å¸ƒæƒ…å†µ:
    - Sports: 213 (21.3%)
    - Fashion: 209 (20.9%)
    - Travel: 196 (19.6%)
    - Food: 196 (19.6%)
    - Technology: 186 (18.6%)

ã€Product_Category_Preferenceã€‘
  å”¯ä¸€å€¼æ•°é‡: 5
  å”¯ä¸€å€¼: ['Books' 'Electronics' 'Apparel' 'Health & Beauty' 'Home & Kitchen']
  åˆ†å¸ƒæƒ…å†µ:
    - Apparel: 218 (21.8%)
    - Electronics: 209 (20.9%)
    - Books: 198 (19.8%)
    - Home & Kitchen: 189 (18.9%)
    - Health & Beauty: 186 (18.6%)
```
{{< /admonition >}}



## 4.5 æ•°æ®è´¨é‡æ€»ç»“

 **æ•°æ®è´¨é‡è¯„ä¼°ç»“æœï¼šä¼˜ç§€**

- âœ“ **æ— ç¼ºå¤±å€¼**ï¼šæ‰€æœ‰å­—æ®µæ•°æ®å®Œæ•´ï¼Œæ— éœ€è¿›è¡Œç¼ºå¤±å€¼å¤„ç†
- âœ“ **æ— é‡å¤å€¼**ï¼šæ•°æ®è®°å½•å”¯ä¸€ï¼Œæ— é‡å¤æ ·æœ¬
- âœ“ **æ•°æ®ç±»å‹æ­£ç¡®**ï¼šå„å­—æ®µç±»å‹ç¬¦åˆä¸šåŠ¡é€»è¾‘
- âœ“ **æ•°å€¼èŒƒå›´åˆç†**ï¼šæœªå‘ç°æ˜æ˜¾çš„å¼‚å¸¸å€¼æˆ–é”™è¯¯æ•°æ®

**ç»“è®º**ï¼šè¯¥æ•°æ®é›†è´¨é‡è‰¯å¥½ï¼Œå¯ç›´æ¥è¿›å…¥åˆ†æé˜¶æ®µï¼Œæ— éœ€é¢å¤–çš„æ•°æ®æ¸…æ´—å·¥ä½œã€‚

# 5. æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰

## 5.1 åˆ†ç±»å˜é‡å¯è§†åŒ–åˆ†æ

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 1. æ€§åˆ«åˆ†å¸ƒ - é¥¼å›¾
gender_count = df['Gender'].value_counts()
pie_gender = (
    Pie(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add(
        series_name="æ€§åˆ«åˆ†å¸ƒ",
        data_pair=[(k, int(v)) for k, v in gender_count.items()],
        radius=["30%", "60%"],
        label_opts=opts.LabelOpts(formatter="{b}: {c}äºº ({d}%)"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="ç”¨æˆ·æ€§åˆ«åˆ†å¸ƒ", subtitle=f"æ€»ç”¨æˆ·æ•°: {len(df)}", pos_left="center"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_right="5%", pos_top="15%"),
    )
    .set_series_opts(
        tooltip_opts=opts.TooltipOpts(trigger="item", formatter="{b}: {c}äºº ({d}%)")
    )
)
pie_gender.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "ç”¨æˆ·æ€§åˆ«åˆ†å¸ƒ",
    "subtext": "æ€»ç”¨æˆ·æ•°: 1000",
    "left": "center",
    "textStyle": {
      "fontSize": 18
    }
  },
  "tooltip": {
    "trigger": "item",
    "formatter": "{b}: {c}äºº ({d}%)"
  },
  "legend": {
    "orient": "vertical",
    "right": "5%",
    "top": "15%"
  },
  "series": [{
    "name": "æ€§åˆ«åˆ†å¸ƒ",
    "type": "pie",
    "radius": ["30%", "60%"],
    "label": {
      "formatter": "{b}: {c}äºº ({d}%)"
    },
    "data": [
      {"value": 526, "name": "Male"},
      {"value": 474, "name": "Female"}
    ]
  }]
}
```

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 2. åœ°åŒºåˆ†å¸ƒ - æŸ±çŠ¶å›¾
location_count = df['Location'].value_counts().sort_values(ascending=False)
bar_location = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis(location_count.index.tolist())
    .add_yaxis(
        "ç”¨æˆ·æ•°é‡",
        location_count.values.tolist(),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="ç”¨æˆ·åœ°åŒºåˆ†å¸ƒ", subtitle="ä¸åŒåœ°åŒºç”¨æˆ·æ•°é‡ç»Ÿè®¡", pos_left="center"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=0)),
        yaxis_opts=opts.AxisOpts(name="ç”¨æˆ·æ•°é‡"),
        toolbox_opts=opts.ToolboxOpts(),
    )
)
bar_location.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "ç”¨æˆ·åœ°åŒºåˆ†å¸ƒ",
    "subtext": "ä¸åŒåœ°åŒºç”¨æˆ·æ•°é‡ç»Ÿè®¡",
    "left": "center"
  },
  "tooltip": {},
  "xAxis": {
    "type": "category",
    "data": ["Suburban", "Urban", "Rural"]
  },
  "yAxis": {
    "type": "value",
    "name": "ç”¨æˆ·æ•°é‡"
  },
  "series": [{
    "name": "ç”¨æˆ·æ•°é‡",
    "type": "bar",
    "data": [349, 344, 307],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": {
        "type": "linear",
        "x": 0,
        "y": 0,
        "x2": 0,
        "y2": 1,
        "colorStops": [
          {"offset": 0, "color": "#83bff6"},
          {"offset": 1, "color": "#188df0"}
        ]
      }
    }
  }],
  "toolbox": {
    "show": true,
    "feature": {
      "saveAsImage": {},
      "restore": {}
    }
  }
}
```

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 3. å…´è¶£åˆ†å¸ƒ - æŸ±çŠ¶å›¾
interests_count = df['Interests'].value_counts().sort_values(ascending=False)
bar_interests = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis(interests_count.index.tolist())
    .add_yaxis(
        "ç”¨æˆ·æ•°é‡",
        interests_count.values.tolist(),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="ç”¨æˆ·å…´è¶£åˆ†å¸ƒ", subtitle="ä¸åŒå…´è¶£çˆ±å¥½ç”¨æˆ·æ•°é‡", pos_left="center"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-15)),
        yaxis_opts=opts.AxisOpts(name="ç”¨æˆ·æ•°é‡"),
    )
)
bar_interests.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "ç”¨æˆ·å…´è¶£åˆ†å¸ƒ",
    "subtext": "ä¸åŒå…´è¶£çˆ±å¥½ç”¨æˆ·æ•°é‡",
    "left": "center"
  },
  "tooltip": {},
  "xAxis": {
    "type": "category",
    "data": ["Sports", "Fashion", "Travel", "Food", "Technology"],
    "axisLabel": {
      "rotate": -15
    }
  },
  "yAxis": {
    "type": "value",
    "name": "ç”¨æˆ·æ•°é‡"
  },
  "series": [{
    "name": "ç”¨æˆ·æ•°é‡",
    "type": "bar",
    "data": [213, 209, 196, 196, 186],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": {
        "type": "linear",
        "x": 0,
        "y": 0,
        "x2": 0,
        "y2": 1,
        "colorStops": [
          {"offset": 0, "color": "#f78ca0"},
          {"offset": 1, "color": "#ee5a6f"}
        ]
      }
    }
  }]
}
```

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 4. äº§å“ç±»åˆ«åå¥½ - æŸ±çŠ¶å›¾
product_count = df['Product_Category_Preference'].value_counts().sort_values(ascending=False)
bar_product = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis(product_count.index.tolist())
    .add_yaxis(
        "ç”¨æˆ·æ•°é‡",
        product_count.values.tolist(),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="äº§å“ç±»åˆ«åå¥½åˆ†å¸ƒ", subtitle="ç”¨æˆ·åå¥½çš„äº§å“ç±»åˆ«ç»Ÿè®¡", pos_left="center"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-15)),
        yaxis_opts=opts.AxisOpts(name="ç”¨æˆ·æ•°é‡"),
    )
)
bar_product.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "äº§å“ç±»åˆ«åå¥½åˆ†å¸ƒ",
    "subtext": "ç”¨æˆ·åå¥½çš„äº§å“ç±»åˆ«ç»Ÿè®¡",
    "left": "center"
  },
  "tooltip": {},
  "xAxis": {
    "type": "category",
    "data": ["Apparel", "Electronics", "Books", "Home & Kitchen", "Health & Beauty"],
    "axisLabel": {
      "rotate": -15
    }
  },
  "yAxis": {
    "type": "value",
    "name": "ç”¨æˆ·æ•°é‡"
  },
  "series": [{
    "name": "ç”¨æˆ·æ•°é‡",
    "type": "bar",
    "data": [218, 209, 198, 189, 186],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": {
        "type": "linear",
        "x": 0,
        "y": 0,
        "x2": 0,
        "y2": 1,
        "colorStops": [
          {"offset": 0, "color": "#FFDB5C"},
          {"offset": 1, "color": "#FF9800"}
        ]
      }
    }
  }]
}
```

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 5. æ–°é—»è®¢é˜…åˆ†å¸ƒ - é¥¼å›¾
newsletter_count = df['Newsletter_Subscription'].value_counts()
newsletter_data = [["å·²è®¢é˜…" if k else "æœªè®¢é˜…", int(v)] for k, v in newsletter_count.items()]
pie_newsletter = (
    Pie(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add(
        series_name="è®¢é˜…çŠ¶æ€",
        data_pair=newsletter_data,
        radius=["30%", "60%"],
        label_opts=opts.LabelOpts(formatter="{b}: {c}äºº ({d}%)"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="è¥é”€é‚®ä»¶è®¢é˜…åˆ†å¸ƒ", subtitle=f"æ€»ç”¨æˆ·æ•°: {len(df)}", pos_left="center"),
        legend_opts=opts.LegendOpts(orient="vertical", pos_right="5%", pos_top="15%"),
    )
    .set_colors(["#5470c6", "#91cc75"])
)
pie_newsletter.render_notebook()

```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "è¥é”€é‚®ä»¶è®¢é˜…åˆ†å¸ƒ",
    "subtext": "æ€»ç”¨æˆ·æ•°: 1000",
    "left": "center"
  },
  "tooltip": {
    "trigger": "item"
  },
  "legend": {
    "orient": "vertical",
    "right": "5%",
    "top": "15%"
  },
  "series": [{
    "name": "è®¢é˜…çŠ¶æ€",
    "type": "pie",
    "radius": ["30%", "60%"],
    "label": {
      "formatter": "{b}: {c}äºº ({d}%)"
    },
    "data": [
      {"value": 512, "name": "å·²è®¢é˜…"},
      {"value": 488, "name": "æœªè®¢é˜…"}
    ]
  }],
  "color": ["#5470c6", "#91cc75"]
}
```

## 5.2 åˆ†ç±»å˜é‡åˆ†æç»“è®º

### å…³é”®å‘ç°

**Genderï¼ˆæ€§åˆ«åˆ†å¸ƒï¼‰**
- **ç°çŠ¶**ï¼šç”·æ€§ç”¨æˆ·ç•¥å¤šäºå¥³æ€§ç”¨æˆ·
- **å•†ä¸šæ´å¯Ÿ**ï¼šç”¨æˆ·æ€§åˆ«åˆ†å¸ƒç›¸å¯¹å‡è¡¡ï¼Œéœ€è¦å¹³è¡¡ç”·å¥³æ€§äº§å“å’Œè¥é”€ç­–ç•¥
- **å»ºè®®**ï¼šå¼€å‘é€‚åˆä¸åŒæ€§åˆ«çš„äº§å“çº¿å’Œæ¨èç®—æ³•

**Locationï¼ˆåœ°åŒºåˆ†å¸ƒï¼‰**
- **ç°çŠ¶**ï¼šéƒŠåŒºå’ŒåŸå¸‚ç”¨æˆ·å ä¸»å¯¼ï¼Œå†œæ‘ç”¨æˆ·ç›¸å¯¹è¾ƒå°‘
- **å•†ä¸šæ´å¯Ÿ**ï¼šåŸå¸‚å’ŒéƒŠåŒºç”¨æˆ·æ˜¯ä¸»è¦å®¢æˆ·ç¾¤ä½“ï¼Œç‰©æµé…é€åº”é‡ç‚¹è¦†ç›–è¿™äº›åŒºåŸŸ
- **å»ºè®®**ï¼šé’ˆå¯¹åŸéƒŠç”¨æˆ·æä¾›å¿«é€Ÿé…é€æœåŠ¡ï¼Œé€æ­¥æ‹“å±•å†œæ‘å¸‚åœº

**Interestsï¼ˆå…´è¶£åˆ†å¸ƒï¼‰**
- **ç°çŠ¶**ï¼šä½“è‚²å’Œæ—¶å°šé¢†åŸŸç”¨æˆ·æœ€å¤šï¼Œç§‘æŠ€ã€æ—…è¡Œã€é£Ÿç‰©æ¬¡ä¹‹
- **å•†ä¸šæ´å¯Ÿ**ï¼šç”¨æˆ·å…´è¶£å¤šå…ƒåŒ–ï¼Œä½“è‚²å’Œæ—¶å°šç±»å†…å®¹æœ€å—æ¬¢è¿
- **å»ºè®®**ï¼šåŠ å¼ºä½“è‚²å’Œæ—¶å°šç±»å•†å“çš„è¿è¥ï¼ŒåŒæ—¶ä¸°å¯Œå…¶ä»–å“ç±»

**Product_Category_Preferenceï¼ˆäº§å“åå¥½ï¼‰**
- **ç°çŠ¶**ï¼šæœè£…ã€ç”µå­è®¾å¤‡å’Œä¹¦ç±æœ€å—æ¬¢è¿ï¼Œå¥åº·ç¾å®¹å’Œå®¶å±…å¨æˆ¿æ¬¡ä¹‹
- **å•†ä¸šæ´å¯Ÿ**ï¼šæœè£…å’Œç”µå­äº§å“æ˜¯æ ¸å¿ƒå“ç±»ï¼Œåº”åŠ å¤§åº“å­˜å’Œè¥é”€æŠ•å…¥
- **å»ºè®®**ï¼šä¼˜åŒ–è¿™äº›çƒ­é—¨ç±»åˆ«çš„ä¾›åº”é“¾ï¼ŒåŒæ—¶æŒ–æ˜æ½œåŠ›å“ç±»

**Newsletter_Subscriptionï¼ˆè¥é”€è®¢é˜…ï¼‰**
- **ç°çŠ¶**ï¼šçº¦51%ç”¨æˆ·è®¢é˜…äº†è¥é”€æ´»åŠ¨é€šçŸ¥
- **å•†ä¸šæ´å¯Ÿ**ï¼šè¶…è¿‡ä¸€åŠç”¨æˆ·æ„¿æ„æ¥å—è¥é”€ä¿¡æ¯ï¼Œæ˜¯æ½œåœ¨çš„å¯è§¦è¾¾ç”¨æˆ·ç¾¤
- **å»ºè®®**ï¼šä¼˜åŒ–é‚®ä»¶è¥é”€å†…å®¹ï¼Œæé«˜è½¬åŒ–ç‡ï¼›å¸å¼•æ›´å¤šç”¨æˆ·è®¢é˜…

# 6. ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ

ç”¨æˆ·æ´»è·ƒåº¦æ˜¯è¡¡é‡ç”¨æˆ·ä»·å€¼çš„é‡è¦æŒ‡æ ‡ã€‚æˆ‘ä»¬å°†ä»æ€§åˆ«ã€åœ°åŒºã€å¹´é¾„ç­‰å¤šä¸ªç»´åº¦åˆ†æç”¨æˆ·æ´»è·ƒåº¦ç‰¹å¾ã€‚

## 6.1 åˆ†ææ€è·¯

æˆ‘ä»¬å°†ä»ä»¥ä¸‹ä¸‰ä¸ªå…³é”®ç»´åº¦å¯¹ç”¨æˆ·æ´»è·ƒåº¦è¿›è¡Œæ·±å…¥åˆ†æï¼š

1. **æ€§åˆ«ç»´åº¦**ï¼šæ¯”è¾ƒç”·å¥³ç”¨æˆ·åœ¨æ´»è·ƒåº¦æŒ‡æ ‡ä¸Šçš„å·®å¼‚
2. **åœ°ç†ä½ç½®ç»´åº¦**ï¼šåˆ†æåŸå¸‚ã€éƒŠåŒºã€å†œæ‘ç”¨æˆ·çš„æ´»è·ƒåº¦ç‰¹å¾
3. **å¹´é¾„ç»´åº¦**ï¼šåˆ’åˆ†å¹´é¾„æ®µï¼Œè¯†åˆ«ä¸åŒå¹´é¾„å±‚çš„æ´»è·ƒåº¦æ¨¡å¼
   - 18-24å²ï¼šé’å°‘å¹´ç¾¤ä½“
   - 25-39å²ï¼šé’å¹´ç¾¤ä½“
   - 40-59å²ï¼šä¸­å¹´ç¾¤ä½“
   - 60å²ä»¥ä¸Šï¼šè€å¹´ç¾¤ä½“

### æ ¸å¿ƒæ´»è·ƒåº¦æŒ‡æ ‡

- **Purchase_Frequency**ï¼šè´­ä¹°é¢‘ç‡
- **Last_Login_Days_Ago**ï¼šæœ€è¿‘ç™»å½•å¤©æ•°ï¼ˆè¶Šå°è¶Šæ´»è·ƒï¼‰
- **Time_Spent_on_Site_Hours**ï¼šç½‘ç«™åœç•™æ—¶é•¿
- **Pages_Viewed**ï¼šæµè§ˆé¡µæ•°

## 6.2 æ•°æ®å‡†å¤‡ä¸ç‰¹å¾å·¥ç¨‹

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# åˆ›å»ºåˆ†ææ•°æ®é›†å‰¯æœ¬
act_df = df.copy()

# å¹´é¾„åˆ†æ®µ
act_df['Age_Group'] = pd.cut(
    act_df['Age'],
    bins=[18, 25, 40, 60, np.inf],
    labels=['18-24å²é’å°‘å¹´', '25-39å²é’å¹´', '40-59å²ä¸­å¹´', '60å²ä»¥ä¸Šè€å¹´']
)

# è½¬æ¢æ—¶é—´å•ä½ï¼ˆåˆ†é’Ÿâ†’å°æ—¶ï¼‰ä¾¿äºå¯è§†åŒ–
act_df['Time_Spent_on_Site_Hours'] = (act_df['Time_Spent_on_Site_Minutes'] / 60).round(2)

print(f"\nå¹´é¾„ç»„åˆ†å¸ƒï¼š")
print(act_df['Age_Group'].value_counts().sort_index())
```

```
å¹´é¾„ç»„åˆ†å¸ƒï¼š
Age_Group
18-24å²é’å°‘å¹´    152
25-39å²é’å¹´     295
40-59å²ä¸­å¹´     440
60å²ä»¥ä¸Šè€å¹´       88
Name: count, dtype: int64
```
{{< /admonition >}}



## 6.3 æ€§åˆ«ç»´åº¦æ´»è·ƒåº¦åˆ†æ

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# è®¡ç®—æ€§åˆ«ç»´åº¦çš„å¹³å‡æ´»è·ƒåº¦æŒ‡æ ‡
gender_activity = act_df.groupby('Gender')[
    ['Purchase_Frequency', 'Last_Login_Days_Ago', 'Time_Spent_on_Site_Hours', 'Pages_Viewed']
].mean().round(2)

print("æ€§åˆ«ç»´åº¦æ´»è·ƒåº¦æŒ‡æ ‡ï¼š")
display(gender_activity)
```
{{< /admonition >}}

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æŸ±çŠ¶å›¾å¯¹æ¯”
metrics = ['Purchase_Frequency', 'Last_Login_Days_Ago', 'Time_Spent_on_Site_Hours', 'Pages_Viewed']
metric_names = ['è´­ä¹°é¢‘ç‡', 'æœ€è¿‘ç™»å½•å¤©æ•°', 'åœç•™æ—¶é•¿(å°æ—¶)', 'æµè§ˆé¡µæ•°']

bar_gender = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis(metric_names)
)

for gender in gender_activity.index:
    values = [gender_activity.loc[gender, m] for m in metrics]
    bar_gender.add_yaxis(
        gender,
        [round(v, 2) for v in values],
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )

bar_gender.set_global_opts(
    title_opts=opts.TitleOpts(title="æ€§åˆ«ç»´åº¦ç”¨æˆ·æ´»è·ƒåº¦å¯¹æ¯”", subtitle="å„æŒ‡æ ‡å¹³å‡å€¼", pos_left="center"),
    yaxis_opts=opts.AxisOpts(name="å¹³å‡å€¼"),
    xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-15)),
    toolbox_opts=opts.ToolboxOpts(),
    legend_opts=opts.LegendOpts(pos_top="8%"),
)
bar_gender.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "æ€§åˆ«ç»´åº¦ç”¨æˆ·æ´»è·ƒåº¦å¯¹æ¯”",
    "subtext": "å„æŒ‡æ ‡å¹³å‡å€¼",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis",
    "axisPointer": {"type": "shadow"}
  },
  "legend": {
    "top": "12%",
    "data": ["Male", "Female"]
  },
  "grid": {
    "top": "20%",
    "bottom": "10%",
    "left": "10%",
    "right": "5%"
  },
  "toolbox": {
    "show": true,
    "feature": {
      "saveAsImage": {},
      "restore": {}
    }
  },
  "xAxis": {
    "type": "category",
    "data": ["è´­ä¹°é¢‘ç‡", "æœ€è¿‘ç™»å½•å¤©æ•°", "åœç•™æ—¶é•¿(å°æ—¶)", "æµè§ˆé¡µæ•°"],
    "axisLabel": {"rotate": -15}
  },
  "yAxis": {
    "type": "value",
    "name": "å¹³å‡å€¼"
  },
  "series": [{
    "name": "Male",
    "type": "bar",
    "data": [4.65, 15.44, 4.95, 24.47],
    "label": {
      "show": true,
      "position": "top"
    }
  }, {
    "name": "Female",
    "type": "bar",
    "data": [4.59, 15.53, 4.94, 24.38],
    "label": {
      "show": true,
      "position": "top"
    }
  }]
}
```


## 6.4 åœ°åŒºç»´åº¦æ´»è·ƒåº¦åˆ†æ

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# è®¡ç®—åœ°åŒºç»´åº¦çš„å¹³å‡æ´»è·ƒåº¦æŒ‡æ ‡
location_activity = act_df.groupby('Location')[
    ['Purchase_Frequency', 'Last_Login_Days_Ago', 'Time_Spent_on_Site_Hours', 'Pages_Viewed']
].mean().round(2)

print("åœ°åŒºç»´åº¦æ´»è·ƒåº¦æŒ‡æ ‡ï¼š")
display(location_activity)
```
{{< /admonition >}}

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æŸ±çŠ¶å›¾å¯¹æ¯”
bar_location_activity = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis(metric_names)
)

for location in location_activity.index:
    values = [location_activity.loc[location, m] for m in metrics]
    bar_location_activity.add_yaxis(
        location,
        [round(v, 2) for v in values],
        label_opts=opts.LabelOpts(is_show=True, position="top", font_size=10),
    )

bar_location_activity.set_global_opts(
    title_opts=opts.TitleOpts(title="åœ°åŒºç»´åº¦ç”¨æˆ·æ´»è·ƒåº¦å¯¹æ¯”", subtitle="å„æŒ‡æ ‡å¹³å‡å€¼", pos_left="center"),
    yaxis_opts=opts.AxisOpts(name="å¹³å‡å€¼"),
    xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-15)),
    toolbox_opts=opts.ToolboxOpts(),
    legend_opts=opts.LegendOpts(pos_top="8%"),
)
bar_location_activity.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "åœ°åŒºç»´åº¦ç”¨æˆ·æ´»è·ƒåº¦å¯¹æ¯”",
    "subtext": "å„æŒ‡æ ‡å¹³å‡å€¼",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis",
    "axisPointer": {"type": "shadow"}
  },
  "legend": {
    "top": "12%",
    "data": ["Rural", "Suburban", "Urban"]
  },
  "grid": {
    "top": "20%",
    "bottom": "10%",
    "left": "10%",
    "right": "5%"
  },
  "toolbox": {
    "show": true,
    "feature": {
      "saveAsImage": {},
      "restore": {}
    }
  },
  "xAxis": {
    "type": "category",
    "data": ["è´­ä¹°é¢‘ç‡", "æœ€è¿‘ç™»å½•å¤©æ•°", "åœç•™æ—¶é•¿(å°æ—¶)", "æµè§ˆé¡µæ•°"],
    "axisLabel": {"rotate": -15}
  },
  "yAxis": {
    "type": "value",
    "name": "å¹³å‡å€¼"
  },
  "series": [{
    "name": "Rural",
    "type": "bar",
    "data": [4.78, 14.77, 5.12, 24.87],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 10
    }
  }, {
    "name": "Suburban",
    "type": "bar",
    "data": [4.62, 15.44, 4.93, 24.31],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 10
    }
  }, {
    "name": "Urban",
    "type": "bar",
    "data": [4.51, 15.79, 4.82, 24.15],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 10
    }
  }]
}
```


## 6.5 å¹´é¾„ç»´åº¦æ´»è·ƒåº¦åˆ†æ

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# è®¡ç®—å¹´é¾„ç»´åº¦çš„å¹³å‡æ´»è·ƒåº¦æŒ‡æ ‡
age_activity = act_df.groupby('Age_Group')[
    ['Purchase_Frequency', 'Last_Login_Days_Ago', 'Time_Spent_on_Site_Hours', 'Pages_Viewed']
].mean().round(2)

print("å¹´é¾„ç»´åº¦æ´»è·ƒåº¦æŒ‡æ ‡ï¼š")
display(age_activity)
```
{{< /admonition >}}

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æŸ±çŠ¶å›¾å¯¹æ¯”
bar_age_activity = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis(metric_names)
)

for age_group in age_activity.index:
    values = [age_activity.loc[age_group, m] for m in metrics]
    bar_age_activity.add_yaxis(
        age_group,
        [round(v, 2) for v in values],
        label_opts=opts.LabelOpts(is_show=True, position="top", font_size=9),
    )

bar_age_activity.set_global_opts(
    title_opts=opts.TitleOpts(title="å¹´é¾„ç»´åº¦ç”¨æˆ·æ´»è·ƒåº¦å¯¹æ¯”", subtitle="å„æŒ‡æ ‡å¹³å‡å€¼", pos_left="center"),
    yaxis_opts=opts.AxisOpts(name="å¹³å‡å€¼"),
    xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-15)),
    toolbox_opts=opts.ToolboxOpts(),
    legend_opts=opts.LegendOpts(pos_top="8%"),
)
bar_age_activity.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "å¹´é¾„ç»´åº¦ç”¨æˆ·æ´»è·ƒåº¦å¯¹æ¯”",
    "subtext": "å„æŒ‡æ ‡å¹³å‡å€¼",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis",
    "axisPointer": {"type": "shadow"}
  },
  "legend": {
    "top": "12%",
    "data": ["18-24å²é’å°‘å¹´", "25-39å²é’å¹´", "40-59å²ä¸­å¹´", "60å²ä»¥ä¸Šè€å¹´"]
  },
  "grid": {
    "top": "20%",
    "bottom": "10%",
    "left": "10%",
    "right": "5%"
  },
  "toolbox": {
    "show": true,
    "feature": {
      "saveAsImage": {},
      "restore": {}
    }
  },
  "xAxis": {
    "type": "category",
    "data": ["è´­ä¹°é¢‘ç‡", "æœ€è¿‘ç™»å½•å¤©æ•°", "åœç•™æ—¶é•¿(å°æ—¶)", "æµè§ˆé¡µæ•°"],
    "axisLabel": {"rotate": -15}
  },
  "yAxis": {
    "type": "value",
    "name": "å¹³å‡å€¼"
  },
  "series": [{
    "name": "18-24å²é’å°‘å¹´",
    "type": "bar",
    "data": [4.89, 14.88, 5.02, 24.56],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 9
    }
  }, {
    "name": "25-39å²é’å¹´",
    "type": "bar",
    "data": [4.68, 15.11, 4.97, 24.45],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 9
    }
  }, {
    "name": "40-59å²ä¸­å¹´",
    "type": "bar",
    "data": [4.55, 15.44, 4.91, 24.32],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 9
    }
  }, {
    "name": "60å²ä»¥ä¸Šè€å¹´",
    "type": "bar",
    "data": [4.42, 15.77, 4.89, 24.78],
    "label": {
      "show": true,
      "position": "top",
      "fontSize": 9
    }
  }]
}
```


## 6.6 ç”¨æˆ·æ´»è·ƒåº¦åˆ†æç»“è®º

###  æ ¸å¿ƒå‘ç°ä¸å•†ä¸šæ´å¯Ÿ

#### 1ï¸âƒ£ æ€§åˆ«ç»´åº¦åˆ†æ

**å…³é”®å‘ç°ï¼š**
- ç”·å¥³ç”¨æˆ·åœ¨è´­ä¹°é¢‘ç‡ã€æœ€è¿‘ç™»å½•å¤©æ•°ã€ç½‘ç«™åœç•™æ—¶é•¿ä¸Šå·®å¼‚ä¸å¤§
- å¥³æ€§ç”¨æˆ·çš„é¡µé¢æµè§ˆé‡ç•¥é«˜äºç”·æ€§ç”¨æˆ·ï¼ˆçº¦é«˜5-10%ï¼‰

**å•†ä¸šæ´å¯Ÿï¼š**
- æ€§åˆ«å› ç´ å¯¹ç”¨æˆ·æ´»è·ƒåº¦å½±å“æœ‰é™
- å¥³æ€§ç”¨æˆ·æ›´å€¾å‘äºæµè§ˆå’Œæ¯”è¾ƒï¼Œå¯èƒ½æ›´æ³¨é‡äº§å“ç»†èŠ‚
- å»ºè®®ï¼šä¸ºå¥³æ€§ç”¨æˆ·æä¾›æ›´è¯¦ç»†çš„äº§å“å±•ç¤ºå’Œå¯¹æ¯”åŠŸèƒ½

#### 2ï¸âƒ£ åœ°åŒºç»´åº¦åˆ†æ

**å…³é”®å‘ç°ï¼š**
- å†œæ‘ç”¨æˆ·è´­ä¹°é¢‘ç‡æœ€é«˜ï¼Œæ˜¾ç¤ºå‡ºè¾ƒå¼ºçš„è´­ä¹°æ„æ„¿
- å†œæ‘ç”¨æˆ·æœ€è¿‘ç™»å½•å¤©æ•°æœ€çŸ­ï¼Œæ´»è·ƒåº¦æœ€é«˜
- å†œæ‘ç”¨æˆ·ç½‘ç«™åœç•™æ—¶é•¿å’Œé¡µé¢æµè§ˆé‡å‡é¢†å…ˆ

**å•†ä¸šæ´å¯Ÿï¼š**
- å†œæ‘å¸‚åœºæ½œåŠ›å·¨å¤§ï¼Œç”¨æˆ·æ´»è·ƒåº¦å’Œè½¬åŒ–ç‡é«˜
- å¯èƒ½åŸå› ï¼šå†œæ‘çº¿ä¸‹è´­ç‰©æ¸ é“æœ‰é™ï¼Œçº¿ä¸Šè´­ç‰©æˆä¸ºä¸»è¦é€‰æ‹©
- å»ºè®®ï¼š
  - åŠ å¤§å†œæ‘å¸‚åœºæ¨å¹¿åŠ›åº¦
  - ä¼˜åŒ–å†œæ‘ç‰©æµé…é€ç½‘ç»œ
  - é’ˆå¯¹å†œæ‘ç”¨æˆ·ç‰¹ç‚¹å¼€å‘ä¸“å±äº§å“å’ŒæœåŠ¡

#### 3ï¸âƒ£ å¹´é¾„ç»´åº¦åˆ†æ

**å…³é”®å‘ç°ï¼š**
- **18-24å²é’å°‘å¹´**ï¼šè´­ä¹°é¢‘ç‡é«˜ï¼Œæ´»è·ƒåº¦é¢†å…ˆï¼Œæ˜¯æœ€æ´»è·ƒçš„ç”¨æˆ·ç¾¤ä½“
- **60å²ä»¥ä¸Šè€å¹´**ï¼šé¡µé¢æµè§ˆé‡çªå‡ºï¼Œæ˜¾ç¤ºå‡ºè¾ƒå¼ºçš„æ¢ç´¢æ„æ„¿
- **25-39å²é’å¹´å’Œ40-59å²ä¸­å¹´**ï¼šå„é¡¹æŒ‡æ ‡ç›¸å¯¹å‡è¡¡

**å•†ä¸šæ´å¯Ÿï¼š**
- é’å°‘å¹´ç¾¤ä½“æ˜¯æ ¸å¿ƒæ´»è·ƒç”¨æˆ·ï¼Œæ¶ˆè´¹æ½œåŠ›å¤§
- è€å¹´ç”¨æˆ·è™½ç„¶æµè§ˆå¤šä½†è´­ä¹°è½¬åŒ–å¯èƒ½è¾ƒä½ï¼Œéœ€è¦ä¼˜åŒ–è´­ä¹°æµç¨‹
- å»ºè®®ï¼š
  - **é’ˆå¯¹é’å°‘å¹´**ï¼šæ¨å‡ºæ—¶å°šã€æ–°æ½®äº§å“ï¼ŒåŠ å¼ºç¤¾äº¤åˆ†äº«åŠŸèƒ½
  - **é’ˆå¯¹è€å¹´äºº**ï¼šç®€åŒ–è´­ä¹°æµç¨‹ï¼Œæä¾›å¤§å­—ä½“ã€æ¸…æ™°çš„ç•Œé¢
  - **é’ˆå¯¹ä¸­å¹´ç¾¤ä½“**ï¼šæä¾›é«˜æ€§ä»·æ¯”ã€å®ç”¨æ€§å¼ºçš„äº§å“

# 7. ç”¨æˆ·ä»·å€¼åˆ†æ

ç”¨æˆ·ä»·å€¼åˆ†ææ˜¯ç²¾å‡†è¥é”€çš„åŸºç¡€ã€‚æˆ‘ä»¬å°†ä½¿ç”¨RFMæ¨¡å‹å’ŒK-Meansèšç±»ç®—æ³•ï¼Œä»ä¸åŒè§’åº¦å¯¹ç”¨æˆ·è¿›è¡Œä»·å€¼åˆ†ç¾¤ã€‚

## 7.1 RFMæ¨¡å‹åˆ†æ

### 7.1.1 RFMæ¨¡å‹åŸç†

RFMæ¨¡å‹æ˜¯ä¸€ç§ç»å…¸çš„ç”¨æˆ·ä»·å€¼è¯„ä¼°æ–¹æ³•ï¼Œé€šè¿‡ä¸‰ä¸ªå…³é”®ç»´åº¦å¯¹ç”¨æˆ·è¿›è¡Œåˆ†ç¾¤ï¼š

**R (Recency) - æœ€è¿‘æ¶ˆè´¹æ—¶é—´**
- **å«ä¹‰**ï¼šç”¨æˆ·æœ€è¿‘ä¸€æ¬¡è´­ä¹°è·ä»Šçš„æ—¶é—´
- **è§£è¯»**ï¼šRå€¼è¶Šå°ï¼Œè¡¨ç¤ºç”¨æˆ·è¶Šæ´»è·ƒï¼Œæµå¤±é£é™©è¶Šä½
- **ä¸šåŠ¡ä»·å€¼**ï¼šè¯†åˆ«æ´»è·ƒç”¨æˆ·å’Œæµå¤±é£é™©ç”¨æˆ·

**F (Frequency) - æ¶ˆè´¹é¢‘ç‡**
- **å«ä¹‰**ï¼šç”¨æˆ·åœ¨ç‰¹å®šæ—¶é—´æ®µå†…çš„è´­ä¹°æ¬¡æ•°
- **è§£è¯»**ï¼šFå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºç”¨æˆ·ç²˜æ€§è¶Šå¼ºï¼Œå¿ è¯šåº¦è¶Šé«˜
- **ä¸šåŠ¡ä»·å€¼**ï¼šè¯†åˆ«å¿ è¯šç”¨æˆ·å’Œå¶ç„¶ç”¨æˆ·

**M (Monetary) - æ¶ˆè´¹é‡‘é¢**
- **å«ä¹‰**ï¼šç”¨æˆ·çš„ç´¯è®¡æ¶ˆè´¹é‡‘é¢
- **è§£è¯»**ï¼šMå€¼è¶Šå¤§ï¼Œè¡¨ç¤ºç”¨æˆ·è´¡çŒ®åº¦è¶Šé«˜
- **ä¸šåŠ¡ä»·å€¼**ï¼šè¯†åˆ«é«˜ä»·å€¼ç”¨æˆ·å’Œæ™®é€šç”¨æˆ·

###  7.1.2 ç”¨æˆ·åˆ†ç¾¤ç­–ç•¥

åŸºäºRFMä¸‰ä¸ªç»´åº¦çš„é«˜ä½ç»„åˆï¼Œæˆ‘ä»¬å°†ç”¨æˆ·åˆ†ä¸º8ä¸ªç±»å‹ï¼š

| ç”¨æˆ·ç±»å‹ | R | F | M | ç‰¹å¾æè¿° |
|---------|---|---|---|---------|
| **é‡è¦ä»·å€¼å®¢æˆ·** | é«˜ | é«˜ | é«˜ | æœ€è¿‘æ´»è·ƒã€é«˜é¢‘è´­ä¹°ã€é«˜æ¶ˆè´¹é‡‘é¢ - VIPå®¢æˆ· |
| **é‡è¦ä¿æŒå®¢æˆ·** | ä½ | é«˜ | é«˜ | è¾ƒä¹…æœªç™»å½•ä½†å†å²é«˜é¢‘é«˜æ¶ˆè´¹ - éœ€è¦å”¤å› |
| **é‡è¦å‘å±•å®¢æˆ·** | é«˜ | ä½ | é«˜ | æœ€è¿‘æ´»è·ƒã€ä½é¢‘ä½†é«˜æ¶ˆè´¹ - æ½œåŠ›å®¢æˆ· |
| **é‡è¦æŒ½ç•™å®¢æˆ·** | ä½ | ä½ | é«˜ | ä¹…æœªç™»å½•ã€ä½é¢‘ä½†é«˜æ¶ˆè´¹ - æµå¤±é£é™© |
| **ä¸€èˆ¬ä»·å€¼å®¢æˆ·** | é«˜ | é«˜ | ä½ | æœ€è¿‘æ´»è·ƒã€é«˜é¢‘ä½†ä½æ¶ˆè´¹ - å¯æå‡å®¢å•ä»· |
| **ä¸€èˆ¬ä¿æŒå®¢æˆ·** | ä½ | é«˜ | ä½ | è¾ƒä¹…æœªç™»å½•ã€é«˜é¢‘ä½†ä½æ¶ˆè´¹ |
| **ä¸€èˆ¬å‘å±•å®¢æˆ·** | é«˜ | ä½ | ä½ | æœ€è¿‘æ´»è·ƒä½†ä½é¢‘ä½æ¶ˆè´¹ - æ–°ç”¨æˆ· |
| **ä¸€èˆ¬æŒ½ç•™å®¢æˆ·** | ä½ | ä½ | ä½ | å…¨é¢è¡¨ç°ä¸ä½³ - æµå¤±ç”¨æˆ· |

### 7.1.3 æ„å»ºRFMæ•°æ®é›†

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æ­¥éª¤1ï¼šæå–RFMåŸå§‹æ•°æ®
rfm_df = df[['User_ID', 'Last_Login_Days_Ago', 'Purchase_Frequency', 'Total_Spending']].copy()

# é‡å‘½ååˆ—ä¸ºæ ‡å‡†çš„RFMå‘½å
rfm_df = rfm_df.rename(columns={
    'Last_Login_Days_Ago': 'R',  # Recency - æœ€è¿‘ç™»å½•å¤©æ•°
    'Purchase_Frequency': 'F',    # Frequency - è´­ä¹°é¢‘ç‡  
    'Total_Spending': 'M'         # Monetary - æ€»æ¶ˆè´¹é‡‘é¢
})

print("="*70)
print(" RFMåŸå§‹æ•°æ®é¢„è§ˆ")
print("="*70)
display(rfm_df.head(10))

print("\n" + "="*70)
print(" RFMæŒ‡æ ‡æè¿°æ€§ç»Ÿè®¡")
print("="*70)
display(rfm_df[['R', 'F', 'M']].describe().round(2))
```
{{< /admonition >}}

### 7.1.4 RFMåˆ†æ•°è®¡ç®—

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æ­¥éª¤2ï¼šè®¡ç®—RFMåˆ†æ•°ï¼ˆ1-5åˆ†ï¼‰

# Råˆ†æ•°ï¼šå¤©æ•°è¶Šå°ï¼Œåˆ†æ•°è¶Šé«˜ï¼ˆä½¿ç”¨è´Ÿå€¼åè½¬ï¼‰
rfm_df['R_Score'] = pd.qcut(
    -rfm_df['R'],           # ä½¿ç”¨è´Ÿå€¼åè½¬ï¼Œä½¿å¾—å¤©æ•°å°çš„ç”¨æˆ·å¾—é«˜åˆ†
    q=5,                    # åˆ†ä¸º5ä¸ªç­‰çº§
    labels=False,           # è¿”å›æ•°å€¼è€ŒéåŒºé—´æ ‡ç­¾
    duplicates='drop'       # å¤„ç†é‡å¤è¾¹ç•Œå€¼
) + 1                       # ä»1å¼€å§‹è®¡åˆ†ï¼ˆè€Œé0ï¼‰

# Fåˆ†æ•°ï¼šé¢‘ç‡è¶Šé«˜ï¼Œåˆ†æ•°è¶Šé«˜
rfm_df['F_Score'] = pd.qcut(
    rfm_df['F'],
    q=5,
    labels=False,
    duplicates='drop'
) + 1

# Måˆ†æ•°ï¼šæ¶ˆè´¹é‡‘é¢è¶Šé«˜ï¼Œåˆ†æ•°è¶Šé«˜
rfm_df['M_Score'] = pd.qcut(
    rfm_df['M'],
    q=5,
    labels=False,
    duplicates='drop'
) + 1

print("="*70)
print(" RFMåˆ†æ•°è®¡ç®—å®Œæˆ")
print("="*70)
display(rfm_df.head(10))
```

```
======================================================================
 RFMåˆ†æ•°è®¡ç®—å®Œæˆ
======================================================================

======================================================================
 RFMåˆ†æ•°åˆ†å¸ƒç»Ÿè®¡
======================================================================

Råˆ†æ•°åˆ†å¸ƒ:
R_Score
1    210
2    220
3    193
4    201
5    176
Name: count, dtype: int64

Fåˆ†æ•°åˆ†å¸ƒ:
F_Score
1    280
2    192
3    227
4    192
5    109
Name: count, dtype: int64

Måˆ†æ•°åˆ†å¸ƒ:
M_Score
1    200
2    200
3    200
4    201
5    199
Name: count, dtype: int64
```
{{< /admonition >}}



### 7.1.5 ç”¨æˆ·æ ‡ç­¾åˆ†ç±»

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æ­¥éª¤3ï¼šè®¾è®¡RFMæ ‡ç­¾åˆ†ç±»å‡½æ•°

def rfm_label(row):
    """æ ¹æ®RFMåˆ†æ•°ä¸ºç”¨æˆ·æ‰“æ ‡ç­¾"""
    R, F, M = row['R_Score'], row['F_Score'], row['M_Score']
    
    # é«˜æ¶ˆè´¹ç”¨æˆ·ï¼ˆM >= 4ï¼‰- é‡è¦å®¢æˆ·
    if M >= 4:
        if R >= 4 and F >= 4:
            return 'é‡è¦ä»·å€¼å®¢æˆ·'     # VIP
        elif R < 4 and F >= 4:
            return 'é‡è¦ä¿æŒå®¢æˆ·'     # éœ€å”¤å›
        elif R >= 4 and F < 4:
            return 'é‡è¦å‘å±•å®¢æˆ·'     # æ½œåŠ›è‚¡
        else:  # R < 4 and F < 4
            return 'é‡è¦æŒ½ç•™å®¢æˆ·'     # æµå¤±é£é™©
    
    # ä½æ¶ˆè´¹ç”¨æˆ·ï¼ˆM < 4ï¼‰- ä¸€èˆ¬å®¢æˆ·
    else:
        if R >= 4 and F >= 4:
            return 'ä¸€èˆ¬ä»·å€¼å®¢æˆ·'     # å¯æå‡å®¢å•ä»·
        elif R < 4 and F >= 4:
            return 'ä¸€èˆ¬ä¿æŒå®¢æˆ·'     # ç»´æŠ¤å¿ è¯šåº¦
        elif R >= 4 and F < 4:
            return 'ä¸€èˆ¬å‘å±•å®¢æˆ·'     # æ–°ç”¨æˆ·
        else:  # R < 4 and F < 4
            return 'ä¸€èˆ¬æŒ½ç•™å®¢æˆ·'     # å·²æµå¤±

# åº”ç”¨æ ‡ç­¾å‡½æ•°
rfm_df['RFM_Label'] = rfm_df.apply(rfm_label, axis=1)

# ç”¨æˆ·æ ‡ç­¾åˆ†ç±»
label_counts = rfm_df['RFM_Label'].value_counts()
for label, count in label_counts.items():
    percentage = count / len(rfm_df) * 100
    print(f"{label}: {count} äºº ({percentage:.1f}%)")
```

```

ä¸€èˆ¬æŒ½ç•™å®¢æˆ·: 257 äºº (25.7%)
é‡è¦æŒ½ç•™å®¢æˆ·: 171 äºº (17.1%)
ä¸€èˆ¬å‘å±•å®¢æˆ·: 169 äºº (16.9%)
ä¸€èˆ¬ä¿æŒå®¢æˆ·: 111 äºº (11.1%)
é‡è¦å‘å±•å®¢æˆ·: 102 äºº (10.2%)
é‡è¦ä¿æŒå®¢æˆ·: 84 äºº (8.4%)
ä¸€èˆ¬ä»·å€¼å®¢æˆ·: 63 äºº (6.3%)
é‡è¦ä»·å€¼å®¢æˆ·: 43 äºº (4.3%)
```
{{< /admonition >}}



### 7.1.6 RFMç”¨æˆ·åˆ†å¸ƒå¯è§†åŒ–

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 1. é¥¼å›¾ï¼šç”¨æˆ·åˆ†ç±»å æ¯”
label_counts = rfm_df['RFM_Label'].value_counts()
pie_data = [(label, int(count)) for label, count in label_counts.items()]

# å®šä¹‰é¢œè‰²æ–¹æ¡ˆï¼šé‡è¦å®¢æˆ·ç”¨æš–è‰²ï¼Œä¸€èˆ¬å®¢æˆ·ç”¨å†·è‰²
color_map = {
    'é‡è¦ä»·å€¼å®¢æˆ·': '#ee5a6f',
    'é‡è¦ä¿æŒå®¢æˆ·': '#f78ca0',
    'é‡è¦å‘å±•å®¢æˆ·': '#fac858',
    'é‡è¦æŒ½ç•™å®¢æˆ·': '#ff9800',
    'ä¸€èˆ¬ä»·å€¼å®¢æˆ·': '#5470c6',
    'ä¸€èˆ¬ä¿æŒå®¢æˆ·': '#73c0de',
    'ä¸€èˆ¬å‘å±•å®¢æˆ·': '#91cc75',
    'ä¸€èˆ¬æŒ½ç•™å®¢æˆ·': '#9a60b4'
}

pie_rfm = (
    Pie(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="500px"))
    .add(
        series_name="ç”¨æˆ·æ•°é‡",
        data_pair=pie_data,
        radius=["35%", "65%"],
        label_opts=opts.LabelOpts(
            formatter="{b}\n{c}äºº ({d}%)",
            font_size=11,
        ),
        itemstyle_opts=opts.ItemStyleOpts(
            border_color="#fff",
            border_width=2
        ),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(
            title="RFMç”¨æˆ·ä»·å€¼åˆ†å¸ƒ",
            subtitle=f"æ€»ç”¨æˆ·æ•°: {len(rfm_df)}",
            pos_left="center",
            title_textstyle_opts=opts.TextStyleOpts(font_size=20),
        ),
        legend_opts=opts.LegendOpts(
            orient="vertical",
            pos_right="3%",
            pos_top="15%",
            item_width=15,
            item_height=15,
        ),
        toolbox_opts=opts.ToolboxOpts(),
    )
    .set_colors([color_map.get(item[0], '#5470c6') for item in pie_data])
)
pie_rfm.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "RFMç”¨æˆ·ä»·å€¼åˆ†å¸ƒ",
    "subtext": "æ€»ç”¨æˆ·æ•°: 1000",
    "left": "center",
    "textStyle": {
      "fontSize": 20
    }
  },
  "tooltip": {
    "trigger": "item",
    "formatter": "{b}<br/>{c}äºº ({d}%)"
  },
  "legend": {
    "orient": "vertical",
    "right": "3%",
    "top": "15%",
    "itemWidth": 15,
    "itemHeight": 15,
    "data": ["ä¸€èˆ¬æŒ½ç•™å®¢æˆ·", "é‡è¦æŒ½ç•™å®¢æˆ·", "ä¸€èˆ¬å‘å±•å®¢æˆ·", "ä¸€èˆ¬ä¿æŒå®¢æˆ·", "é‡è¦å‘å±•å®¢æˆ·", "é‡è¦ä¿æŒå®¢æˆ·", "ä¸€èˆ¬ä»·å€¼å®¢æˆ·", "é‡è¦ä»·å€¼å®¢æˆ·"]
  },
  "toolbox": {
    "show": true,
    "feature": {
      "saveAsImage": {},
      "restore": {}
    }
  },
  "series": [{
    "name": "ç”¨æˆ·æ•°é‡",
    "type": "pie",
    "radius": ["35%", "65%"],
    "label": {
      "formatter": "{b}\n{c}äºº ({d}%)",
      "fontSize": 11
    },
    "itemStyle": {
      "borderColor": "#fff",
      "borderWidth": 2
    },
    "data": [
      {"value": 257, "name": "ä¸€èˆ¬æŒ½ç•™å®¢æˆ·", "itemStyle": {"color": "#9a60b4"}},
      {"value": 171, "name": "é‡è¦æŒ½ç•™å®¢æˆ·", "itemStyle": {"color": "#ff9800"}},
      {"value": 169, "name": "ä¸€èˆ¬å‘å±•å®¢æˆ·", "itemStyle": {"color": "#91cc75"}},
      {"value": 111, "name": "ä¸€èˆ¬ä¿æŒå®¢æˆ·", "itemStyle": {"color": "#73c0de"}},
      {"value": 102, "name": "é‡è¦å‘å±•å®¢æˆ·", "itemStyle": {"color": "#fac858"}},
      {"value": 84, "name": "é‡è¦ä¿æŒå®¢æˆ·", "itemStyle": {"color": "#f78ca0"}},
      {"value": 63, "name": "ä¸€èˆ¬ä»·å€¼å®¢æˆ·", "itemStyle": {"color": "#5470c6"}},
      {"value": 43, "name": "é‡è¦ä»·å€¼å®¢æˆ·", "itemStyle": {"color": "#ee5a6f"}}
    ]
  }]
}
```

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# 2. æŸ±çŠ¶å›¾ï¼šç”¨æˆ·åˆ†ç±»æ•°é‡
bar_rfm = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="450px"))
    .add_xaxis(list(label_counts.index))
    .add_yaxis(
        "ç”¨æˆ·æ•°é‡",
        list(label_counts.values),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="RFMç”¨æˆ·åˆ†ç±»æ•°é‡ç»Ÿè®¡", pos_left="center"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-30, font_size=10)),
        yaxis_opts=opts.AxisOpts(name="ç”¨æˆ·æ•°é‡"),
        toolbox_opts=opts.ToolboxOpts(),
    )
)
bar_rfm.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "RFMç”¨æˆ·åˆ†ç±»æ•°é‡ç»Ÿè®¡",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis",
    "axisPointer": {"type": "shadow"}
  },
  "toolbox": {
    "show": true,
    "feature": {
      "saveAsImage": {},
      "restore": {}
    }
  },
  "xAxis": {
    "type": "category",
    "data": ["ä¸€èˆ¬æŒ½ç•™å®¢æˆ·", "é‡è¦æŒ½ç•™å®¢æˆ·", "ä¸€èˆ¬å‘å±•å®¢æˆ·", "ä¸€èˆ¬ä¿æŒå®¢æˆ·", "é‡è¦å‘å±•å®¢æˆ·", "é‡è¦ä¿æŒå®¢æˆ·", "ä¸€èˆ¬ä»·å€¼å®¢æˆ·", "é‡è¦ä»·å€¼å®¢æˆ·"],
    "axisLabel": {
      "rotate": -30,
      "fontSize": 10
    }
  },
  "yAxis": {
    "type": "value",
    "name": "ç”¨æˆ·æ•°é‡"
  },
  "series": [{
    "name": "ç”¨æˆ·æ•°é‡",
    "type": "bar",
    "data": [
      {"value": 257, "itemStyle": {"color": "#9a60b4"}},
      {"value": 171, "itemStyle": {"color": "#ff9800"}},
      {"value": 169, "itemStyle": {"color": "#91cc75"}},
      {"value": 111, "itemStyle": {"color": "#73c0de"}},
      {"value": 102, "itemStyle": {"color": "#fac858"}},
      {"value": 84, "itemStyle": {"color": "#f78ca0"}},
      {"value": 63, "itemStyle": {"color": "#5470c6"}},
      {"value": 43, "itemStyle": {"color": "#ee5a6f"}}
    ],
    "label": {
      "show": true,
      "position": "top"
    }
  }]
}
```

### 7.1.7 RFMåˆ†æç»“è®ºä¸è¥é”€ç­–ç•¥

#### ç”¨æˆ·åˆ†ç¾¤ç‰¹å¾åˆ†æ

åŸºäºRFMæ¨¡å‹ï¼Œæˆ‘ä»¬è¯†åˆ«å‡ºä»¥ä¸‹8ç±»ç”¨æˆ·ç¾¤ä½“ï¼ˆæŒ‰å æ¯”æ’åºï¼‰ï¼š

**ä¸€èˆ¬æŒ½ç•™å®¢æˆ·ï¼ˆçº¦25.7%ï¼‰- æµå¤±ç”¨æˆ·**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- è¾ƒä¹…æœªç™»å½• + ä½è´­ä¹°é¢‘ç‡ + ä½æ¶ˆè´¹é‡‘é¢
- ç”¨æˆ·ä»·å€¼æœ€ä½ï¼Œæµå¤±é£é™©æœ€é«˜
- å¯¹å¹³å°ç¼ºä¹ç²˜æ€§å’Œè´­ä¹°æ„æ„¿

**è¥é”€ç­–ç•¥**ï¼š
- å‘é€æ¿€æ´»ä¼˜æƒ åˆ¸æˆ–å°ç¤¼å“å¸å¼•å›å½’
- å®šæœŸå‘é€æ–°å“æ¨èå’Œä¿ƒé”€ä¿¡æ¯
- **æ³¨æ„**ï¼šä¸å®œæŠ•å…¥è¿‡å¤šèµ„æºï¼ŒROIè¾ƒä½

---

**é‡è¦æŒ½ç•™å®¢æˆ·ï¼ˆçº¦17.1%ï¼‰- é«˜ä»·å€¼æµå¤±é£é™©**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- è¾ƒä¹…æœªç™»å½• + ä½è´­ä¹°é¢‘ç‡ + **é«˜æ¶ˆè´¹é‡‘é¢**
- å†å²è´¡çŒ®å¤§ä½†è¿‘æœŸä¸æ´»è·ƒ
- **æµå¤±é£é™©é«˜ï¼ŒæŒ½å›ä»·å€¼å¤§**

**è¥é”€ç­–ç•¥**ï¼š
- æä¾›ä¸“å±VIPæŠ˜æ‰£å’Œé«˜ç«¯äº§å“æ¨è
- ä¸»åŠ¨ç”µè¯æˆ–é‚®ä»¶å…³æ€€ï¼Œäº†è§£æµå¤±åŸå› 
- é’ˆå¯¹æ€§æ¨é€ç¬¦åˆå…¶å†å²åå¥½çš„å•†å“
- **ä¼˜å…ˆçº§**ï¼šé«˜ä¼˜å…ˆçº§æŒ½å›

---

**ä¸€èˆ¬å‘å±•å®¢æˆ·ï¼ˆçº¦16.9%ï¼‰- æ–°ç”¨æˆ·/æ½œåŠ›ç”¨æˆ·**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- æœ€è¿‘æ´»è·ƒ + ä½è´­ä¹°é¢‘ç‡ + ä½æ¶ˆè´¹é‡‘é¢
- å¯èƒ½æ˜¯æ–°æ³¨å†Œç”¨æˆ·æˆ–æµè§ˆå‹ç”¨æˆ·
- å…·æœ‰åŸ¹è‚²æ½œåŠ›

**è¥é”€ç­–ç•¥**ï¼š
- ç²¾å‡†æ¨é€ç›¸å…³æ€§é«˜çš„äº§å“ï¼Œä¿ƒè¿›é¦–å•è½¬åŒ–
- æä¾›æ–°äººä¸“äº«ä¼˜æƒ ï¼Œé™ä½è´­ä¹°é—¨æ§›
- å¢å¼ºäº’åŠ¨ï¼Œå¼•å¯¼å…³æ³¨å’Œæ”¶è—
- ä¿ƒè¿›é¦–å•å¤è´­ï¼ŒåŸ¹å…»è´­ç‰©ä¹ æƒ¯

---

**ä¸€èˆ¬ä¿æŒå®¢æˆ·ï¼ˆçº¦11.1%ï¼‰- å¿ è¯šåº¦å¾…æå‡**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- è¾ƒä¹…æœªç™»å½• + **é«˜è´­ä¹°é¢‘ç‡** + ä½æ¶ˆè´¹é‡‘é¢
- å†å²è´­ä¹°æ¬¡æ•°å¤šä½†è¿‘æœŸä¸æ´»è·ƒ
- å®¢å•ä»·è¾ƒä½

**è¥é”€ç­–ç•¥**ï¼š
- æ¨å‡ºç»„åˆå¥—é¤ï¼Œæå‡å®¢å•ä»·
- ç§¯åˆ†å…‘æ¢æé†’ï¼Œå¢å¼ºç²˜æ€§
- ä¼šå‘˜ä¸“äº«ä¼˜æƒ ï¼Œé¼“åŠ±å›å½’
- å‘ä¸Šé”€å”®ï¼Œæ¨èé«˜ä»·å€¼å•†å“

---

**é‡è¦å‘å±•å®¢æˆ·ï¼ˆçº¦10.2%ï¼‰- é«˜æ½œåŠ›ç”¨æˆ·**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- æœ€è¿‘æ´»è·ƒ + ä½è´­ä¹°é¢‘ç‡ + **é«˜æ¶ˆè´¹é‡‘é¢**
- å•æ¬¡æ¶ˆè´¹é«˜ä½†é¢‘ç‡ä½
- å¯èƒ½åå¥½é«˜ç«¯äº§å“

**è¥é”€ç­–ç•¥**ï¼š
- æä¾›VIPæœåŠ¡ä½“éªŒï¼Œå¢å¼ºå“ç‰Œå¿ è¯šåº¦
- æ¨é€ä¸ªæ€§åŒ–é«˜ç«¯äº§å“æ¨è
- ä¸“å±ç¤¼é‡å’Œä¼˜å…ˆè´­ä¹°æƒ
- åŸ¹å…»è´­ä¹°ä¹ æƒ¯ï¼Œæå‡é¢‘ç‡
- **ä¼˜å…ˆçº§**ï¼šé«˜æ½œåŠ›åŸ¹è‚²å¯¹è±¡

---

**é‡è¦ä¿æŒå®¢æˆ·ï¼ˆçº¦8.4%ï¼‰- éœ€å”¤å›çš„VIP**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- è¾ƒä¹…æœªç™»å½• + **é«˜è´­ä¹°é¢‘ç‡ + é«˜æ¶ˆè´¹é‡‘é¢**
- å†å²ä¸Šçš„VIPå®¢æˆ·ï¼Œä½†è¿‘æœŸä¸æ´»è·ƒ
- **é«˜ä»·å€¼ç”¨æˆ·ï¼Œå¿…é¡»é‡ç‚¹ç»´æŠ¤**

**è¥é”€ç­–ç•¥**ï¼š
- ä¸“äººå®¢æˆ·å…³æ€€ï¼Œäº†è§£éœ€æ±‚å˜åŒ–
- å®šåˆ¶åŒ–æœåŠ¡å’Œä¸“å±ä¼˜æƒ 
- å®šæœŸæ´»åŠ¨é‚€è¯·ï¼ˆçº¿ä¸‹æ²™é¾™ã€æ–°å“å‘å¸ƒä¼šï¼‰
- é˜²æ­¢æµå¤±ï¼Œç»´æŠ¤é«˜ç«¯å®¢æˆ·å…³ç³»
- **ä¼˜å…ˆçº§**ï¼šæœ€é«˜ä¼˜å…ˆçº§ç»´æŠ¤

---

**ä¸€èˆ¬ä»·å€¼å®¢æˆ·ï¼ˆçº¦6.3%ï¼‰- æ´»è·ƒå¿ è¯šç”¨æˆ·**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- æœ€è¿‘æ´»è·ƒ + **é«˜è´­ä¹°é¢‘ç‡** + ä½æ¶ˆè´¹é‡‘é¢
- é«˜é¢‘è®¿é—®å’Œè´­ä¹°ï¼Œä½†å®¢å•ä»·ä½
- å¿ è¯šåº¦é«˜ï¼Œæœ‰æå‡ç©ºé—´

**è¥é”€ç­–ç•¥**ï¼š
- æ¨èé«˜ä»·å€¼å•†å“ï¼Œæå‡å®¢å•ä»·
- ä¼˜åŒ–è´­ç‰©ä½“éªŒï¼Œå¢å¼ºæ»¡æ„åº¦
- é¼“åŠ±åˆ†äº«å’Œè¯„è®ºï¼Œåˆ©ç”¨å£ç¢‘ä¼ æ’­
- ä¼šå‘˜å‡çº§æ¿€åŠ±ï¼Œæä¾›æ›´å¤šæƒç›Š

---

**é‡è¦ä»·å€¼å®¢æˆ·ï¼ˆçº¦4.3%ï¼‰- è¶…çº§VIP**

**ç”¨æˆ·ç‰¹å¾**ï¼š
- æœ€è¿‘æ´»è·ƒ + **é«˜è´­ä¹°é¢‘ç‡ + é«˜æ¶ˆè´¹é‡‘é¢**
- **æœ€ä¼˜è´¨çš„å®¢æˆ·ç¾¤ä½“**
- é«˜è´¡çŒ®åº¦ + é«˜å¿ è¯šåº¦

**è¥é”€ç­–ç•¥**ï¼š
- æœ€é«˜çº§åˆ«å®¢æˆ·æœåŠ¡ï¼ˆç§äººè´­ç‰©é¡¾é—®ï¼‰
- ä¸ªæ€§åŒ–ä¸“å±æ¨è
- å°Šäº«æ´»åŠ¨å’Œé™é‡å•†å“ä¼˜å…ˆè´­ä¹°æƒ
- å®šæœŸé«˜ç«¯ç¤¼é‡å’Œæ„Ÿæ©å›é¦ˆ
- å®šæœŸä¸»åŠ¨å…³æ€€ï¼Œç¡®ä¿æŒç»­é«˜æ¶ˆè´¹
- **ä¼˜å…ˆçº§**ï¼šæ ¸å¿ƒèµ„äº§ï¼Œå¿…é¡»å…¨åŠ›ç»´æŠ¤

---

#### æ€»ä½“ç­–ç•¥å»ºè®®

1. **èµ„æºåˆ†é…**ï¼š80%èµ„æºæŠ•å…¥é‡è¦å®¢æˆ·ï¼ˆ40.0%ç”¨æˆ·ï¼‰ï¼Œ20%èµ„æºæŠ•å…¥ä¸€èˆ¬å®¢æˆ·
2. **é‡ç‚¹å…³æ³¨**ï¼šé‡è¦ä»·å€¼å®¢æˆ· > é‡è¦ä¿æŒå®¢æˆ· > é‡è¦æŒ½ç•™å®¢æˆ· > é‡è¦å‘å±•å®¢æˆ·
3. **å·®å¼‚åŒ–æœåŠ¡**ï¼šé’ˆå¯¹ä¸åŒç¾¤ä½“è®¾è®¡ä¸“å±è¥é”€æ–¹æ¡ˆ
4. **åŠ¨æ€ç›‘æ§**ï¼šå®šæœŸæ›´æ–°RFMåˆ†æï¼Œè·Ÿè¸ªç”¨æˆ·çŠ¶æ€å˜åŒ–

## 7.2 K-Meansèšç±»åˆ†æ

è™½ç„¶RFMæ¨¡å‹æä¾›äº†æ˜ç¡®çš„ç”¨æˆ·åˆ†ç±»ï¼Œä½†å®ƒåŸºäºäººä¸ºè®¾å®šçš„é˜ˆå€¼ï¼Œå…·æœ‰ä¸€å®šä¸»è§‚æ€§ã€‚ä¸ºäº†è·å¾—æ›´å®¢è§‚ã€æ•°æ®é©±åŠ¨çš„ç”¨æˆ·åˆ†ç¾¤ç»“æœï¼Œæˆ‘ä»¬å°†é‡‡ç”¨K-Meansèšç±»ç®—æ³•è¿›è¡Œæ·±åº¦åˆ†æã€‚

### 7.2.1 ä¸ºä»€ä¹ˆéœ€è¦K-Meansèšç±»ï¼Ÿ

**RFMæ¨¡å‹çš„å±€é™æ€§ï¼š**
- ä¾èµ–äººä¸ºè®¾å®šçš„é˜ˆå€¼
- å¯èƒ½æ— æ³•æ•æ‰å¤æ‚çš„ç”¨æˆ·è¡Œä¸ºæ¨¡å¼
- å¿½ç•¥äº†å…¶ä»–é‡è¦çš„ç”¨æˆ·ç‰¹å¾

**K-Meansèšç±»çš„ä¼˜åŠ¿ï¼š**
-  å®Œå…¨æ•°æ®é©±åŠ¨ï¼Œæ— äººä¸ºåè§
-  å¯ä»¥æ•´åˆå¤šç»´åº¦ç‰¹å¾è¿›è¡Œç»¼åˆåˆ†æ
-  è‡ªåŠ¨å‘ç°æ•°æ®ä¸­çš„è‡ªç„¶åˆ†ç¾¤
-  æ›´çµæ´»çš„ç‰¹å¾é€‰æ‹©å’Œç»„åˆ

### 7.2.2 ç‰¹å¾å·¥ç¨‹

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æ•´åˆï¼šå¹´é¾„ã€æ”¶å…¥ã€RFMæŒ‡æ ‡ã€è¡Œä¸ºç‰¹å¾

# æ­¥éª¤1ï¼šæ„å»ºç‰¹å¾é›†
cluster_features = df[[
    # ç”¨æˆ·å±æ€§
    'Age',
    'Income',
    # RFMæ ¸å¿ƒæŒ‡æ ‡
    'Last_Login_Days_Ago',      # R - æœ€è¿‘ç™»å½•
    'Purchase_Frequency',        # F - è´­ä¹°é¢‘ç‡
    'Total_Spending',            # M - æ€»æ¶ˆè´¹
    # è¡Œä¸ºç‰¹å¾
    'Average_Order_Value',       # å¹³å‡è®¢å•ä»·å€¼
    'Time_Spent_on_Site_Minutes',  # åœç•™æ—¶é•¿
    'Pages_Viewed',              # æµè§ˆé¡µæ•°
]].copy()

# æ­¥éª¤2ï¼šç‰¹å¾å·¥ç¨‹ - åˆ›å»ºè¡ç”Ÿç‰¹å¾
cluster_features['Value_Density'] = cluster_features['Total_Spending'] / (cluster_features['Purchase_Frequency'] + 1)
cluster_features['Activity_Score'] = 30 - cluster_features['Last_Login_Days_Ago']
cluster_features['Browse_Efficiency'] = cluster_features['Pages_Viewed'] / (cluster_features['Time_Spent_on_Site_Minutes'] + 1)

print(" èšç±»ç‰¹å¾é›†æ„å»ºå®Œæˆ")
print(f"ç‰¹å¾æ•°é‡: {cluster_features.shape[1]}")
print(f"æ ·æœ¬æ•°é‡: {cluster_features.shape[0]}")
```

```
 èšç±»ç‰¹å¾é›†æ„å»ºå®Œæˆ
ç‰¹å¾æ•°é‡: 11
æ ·æœ¬æ•°é‡: 1000
```
{{< /admonition >}}



### 7.2.3 æ•°æ®æ ‡å‡†åŒ–

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# ä½¿ç”¨RobustScaleræ ‡å‡†åŒ–ï¼ˆå¯¹å¼‚å¸¸å€¼æ›´ç¨³å¥ï¼‰
from sklearn.preprocessing import RobustScaler

scaler = RobustScaler()
features_scaled = scaler.fit_transform(cluster_features)

print(" æ•°æ®æ ‡å‡†åŒ–å®Œæˆ")
```
{{< /admonition >}}

### 7.2.4 ç¡®å®šæœ€ä¼˜Kå€¼

è¿™æ˜¯èšç±»åˆ†ææœ€å…³é”®çš„æ­¥éª¤ï¼æˆ‘ä»¬å°†ä½¿ç”¨å¤šç§è¯„ä¼°æŒ‡æ ‡ç»¼åˆåˆ¤æ–­æœ€ä¼˜èšç±»æ•°ã€‚

**è¯„ä¼°æŒ‡æ ‡è¯´æ˜ï¼š**

1. **æ‰‹è‚˜æ³•ï¼ˆElbow Methodï¼‰** - åŸºäºæƒ¯æ€§ï¼ˆInertiaï¼‰
   - è§‚å¯Ÿæƒ¯æ€§éšKå€¼ä¸‹é™çš„æ›²çº¿
   - å¯»æ‰¾"è‚˜éƒ¨"æ‹ç‚¹ï¼ˆä¸‹é™é€Ÿåº¦æ˜æ˜¾å˜ç¼“å¤„ï¼‰
   - æƒ¯æ€§è¶Šå°è¡¨ç¤ºç°‡å†…ç´§å¯†åº¦è¶Šé«˜

2. **è½®å»“ç³»æ•°ï¼ˆSilhouette Scoreï¼‰**
   - èŒƒå›´ï¼š[-1, 1]
   - å€¼è¶Šæ¥è¿‘1è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½
   - ç»¼åˆè€ƒè™‘ç°‡å†…ç´§å¯†åº¦å’Œç°‡é—´åˆ†ç¦»åº¦

3. **Davies-BouldinæŒ‡æ•°ï¼ˆDB Indexï¼‰**
   - å€¼è¶Šå°è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½
   - è¡¡é‡ç°‡å†…ç›¸ä¼¼åº¦ä¸ç°‡é—´å·®å¼‚åº¦çš„æ¯”å€¼

4. **Calinski-HarabaszæŒ‡æ•°ï¼ˆCH Indexï¼‰**
   - å€¼è¶Šå¤§è¡¨ç¤ºèšç±»æ•ˆæœè¶Šå¥½
   - ç°‡é—´æ–¹å·®ä¸ç°‡å†…æ–¹å·®çš„æ¯”å€¼

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# è¯„ä¼°ä¸åŒKå€¼ï¼ˆ2-10ï¼‰çš„èšç±»æ•ˆæœ
k_range = range(2, 11)
metrics_results = {
    'K': [],
    'Inertia': [],
    'Silhouette': [],
    'Davies_Bouldin': [],
    'Calinski_Harabasz': []
}

print("="*70)
print(" æ­£åœ¨è¯„ä¼°ä¸åŒKå€¼çš„èšç±»æ•ˆæœ...")
print("="*70)

for k in k_range:
    # è®­ç»ƒK-Meansæ¨¡å‹
    kmeans = KMeans(n_clusters=k, random_state=42, n_init=10, max_iter=300)
    labels = kmeans.fit_predict(scaled_features)
    
    # è®¡ç®—å„é¡¹è¯„ä¼°æŒ‡æ ‡
    inertia = kmeans.inertia_
    silhouette = silhouette_score(scaled_features, labels)
    db_score = davies_bouldin_score(scaled_features, labels)
    ch_score = calinski_harabasz_score(scaled_features, labels)
    
    # å­˜å‚¨ç»“æœ
    metrics_results['K'].append(k)
    metrics_results['Inertia'].append(inertia)
    metrics_results['Silhouette'].append(silhouette)
    metrics_results['Davies_Bouldin'].append(db_score)
    metrics_results['Calinski_Harabasz'].append(ch_score)
    
    print(f"K={k}: Inertia={inertia:.2f}, Silhouette={silhouette:.4f}, DB={db_score:.4f}, CH={ch_score:.2f}")


# åˆ›å»ºæŒ‡æ ‡DataFrame
metrics_df = pd.DataFrame(metrics_results)
display(metrics_df)
```

```
======================================================================
 æ­£åœ¨è¯„ä¼°ä¸åŒKå€¼çš„èšç±»æ•ˆæœ...
======================================================================
K=2: Inertia=14482.46, Silhouette=0.8075, DB=0.5985, CH=832.03
K=3: Inertia=8265.52, Silhouette=0.7376, DB=0.4839, CH=1103.14
K=4: Inertia=6653.11, Silhouette=0.4540, DB=0.7189, CH=993.21
K=5: Inertia=5340.91, Silhouette=0.4493, DB=0.7433, CH=988.10
K=6: Inertia=4692.94, Silhouette=0.4449, DB=0.7328, CH=926.17
K=7: Inertia=4203.18, Silhouette=0.2111, DB=1.0420, CH=880.16
K=8: Inertia=3808.61, Silhouette=0.2162, DB=0.9515, CH=846.42
K=9: Inertia=3528.29, Silhouette=0.1640, DB=1.1244, CH=808.50
K=10: Inertia=3288.54, Silhouette=0.1632, DB=1.1658, CH=778.30
```
{{< /admonition >}}



#### Kå€¼è¯„ä¼°å¯è§†åŒ–

**1. æ‰‹è‚˜æ³• - InertiaæŒ‡æ ‡**

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æ‰‹è‚˜æ³•å¯è§†åŒ–
line_inertia = (
    Line(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis([str(k) for k in metrics_df['K']])
    .add_yaxis(
        "Inertia",
        metrics_df['Inertia'].round(2).tolist(),
        markpoint_opts=opts.MarkPointOpts(
            data=[opts.MarkPointItem(type_="min", name="æœ€å°å€¼")]
        ),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="æ‰‹è‚˜æ³• - InertiaæŒ‡æ ‡", subtitle="å¯»æ‰¾æ‹ç‚¹ï¼ˆè‚˜éƒ¨ï¼‰", pos_left="center"),
        xaxis_opts=opts.AxisOpts(name="èšç±»æ•°K", type_="category"),
        yaxis_opts=opts.AxisOpts(name="Inertiaï¼ˆè¶Šå°è¶Šå¥½ï¼‰"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
    )
)
line_inertia.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "æ‰‹è‚˜æ³• - InertiaæŒ‡æ ‡",
    "subtext": "å¯»æ‰¾æ‹ç‚¹ï¼ˆè‚˜éƒ¨ï¼‰",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis"
  },
  "xAxis": {
    "type": "category",
    "name": "èšç±»æ•°K",
    "data": ["2", "3", "4", "5", "6", "7", "8", "9", "10"]
  },
  "yAxis": {
    "type": "value",
    "name": "Inertiaï¼ˆè¶Šå°è¶Šå¥½ï¼‰"
  },
  "series": [{
    "name": "Inertia",
    "type": "line",
    "data": [14482.46, 8265.52, 6653.11, 5340.91, 4692.94, 4203.18, 3808.61, 3528.29, 3288.54],
    "label": {
      "show": true,
      "position": "top"
    },
    "markPoint": {
      "data": [
        {"type": "min", "name": "æœ€å°å€¼"}
      ]
    }
  }]
}
```

**2. è½®å»“ç³»æ•°**

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# è½®å»“ç³»æ•°å¯è§†åŒ–
line_silhouette = (
    Line(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis([str(k) for k in metrics_df['K']])
    .add_yaxis(
        "Silhouette Score",
        metrics_df['Silhouette'].round(4).tolist(),
        markpoint_opts=opts.MarkPointOpts(
            data=[opts.MarkPointItem(type_="max", name="æœ€å¤§å€¼")]
        ),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
        itemstyle_opts=opts.ItemStyleOpts(color="#ee5a6f"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="è½®å»“ç³»æ•°", subtitle="å€¼è¶Šæ¥è¿‘1è¶Šå¥½", pos_left="center"),
        xaxis_opts=opts.AxisOpts(name="èšç±»æ•°K", type_="category"),
        yaxis_opts=opts.AxisOpts(name="Silhouette Scoreï¼ˆè¶Šå¤§è¶Šå¥½ï¼‰"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
    )
)
line_silhouette.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "è½®å»“ç³»æ•°",
    "subtext": "å€¼è¶Šæ¥è¿‘1è¶Šå¥½",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis"
  },
  "xAxis": {
    "type": "category",
    "name": "èšç±»æ•°K",
    "data": ["2", "3", "4", "5", "6", "7", "8", "9", "10"]
  },
  "yAxis": {
    "type": "value",
    "name": "Silhouette Scoreï¼ˆè¶Šå¤§è¶Šå¥½ï¼‰"
  },
  "series": [{
    "name": "Silhouette Score",
    "type": "line",
    "data": [0.8075, 0.7376, 0.4540, 0.4493, 0.4449, 0.2111, 0.2162, 0.1640, 0.1632],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": "#ee5a6f"
    },
    "markPoint": {
      "data": [
        {"type": "max", "name": "æœ€å¤§å€¼"}
      ]
    }
  }]
}
```

**3. Davies-BouldinæŒ‡æ•°**

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# Davies-BouldinæŒ‡æ•°å¯è§†åŒ–
line_db = (
    Line(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis([str(k) for k in metrics_df['K']])
    .add_yaxis(
        "Davies-Bouldin Index",
        metrics_df['Davies_Bouldin'].round(4).tolist(),
        markpoint_opts=opts.MarkPointOpts(
            data=[opts.MarkPointItem(type_="min", name="æœ€å°å€¼")]
        ),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
        itemstyle_opts=opts.ItemStyleOpts(color="#fac858"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="Davies-BouldinæŒ‡æ•°", subtitle="å€¼è¶Šå°è¶Šå¥½", pos_left="center"),
        xaxis_opts=opts.AxisOpts(name="èšç±»æ•°K", type_="category"),
        yaxis_opts=opts.AxisOpts(name="DB Indexï¼ˆè¶Šå°è¶Šå¥½ï¼‰"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
    )
)
line_db.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "Davies-BouldinæŒ‡æ•°",
    "subtext": "å€¼è¶Šå°è¶Šå¥½",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis"
  },
  "xAxis": {
    "type": "category",
    "name": "èšç±»æ•°K",
    "data": ["2", "3", "4", "5", "6", "7", "8", "9", "10"]
  },
  "yAxis": {
    "type": "value",
    "name": "DB Indexï¼ˆè¶Šå°è¶Šå¥½ï¼‰"
  },
  "series": [{
    "name": "Davies-Bouldin Index",
    "type": "line",
    "data": [0.5985, 0.4839, 0.7189, 0.7433, 0.7328, 1.0420, 0.9515, 1.1244, 1.1658],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": "#fac858"
    },
    "markPoint": {
      "data": [
        {"type": "min", "name": "æœ€å°å€¼"}
      ]
    }
  }]
}
```

**4. Calinski-HarabaszæŒ‡æ•°**

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# Calinski-HarabaszæŒ‡æ•°å¯è§†åŒ–
line_ch = (
    Line(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis([str(k) for k in metrics_df['K']])
    .add_yaxis(
        "Calinski-Harabasz Index",
        metrics_df['Calinski_Harabasz'].round(2).tolist(),
        markpoint_opts=opts.MarkPointOpts(
            data=[opts.MarkPointItem(type_="max", name="æœ€å¤§å€¼")]
        ),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
        itemstyle_opts=opts.ItemStyleOpts(color="#91cc75"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="Calinski-HarabaszæŒ‡æ•°", subtitle="å€¼è¶Šå¤§è¶Šå¥½", pos_left="center"),
        xaxis_opts=opts.AxisOpts(name="èšç±»æ•°K", type_="category"),
        yaxis_opts=opts.AxisOpts(name="CH Indexï¼ˆè¶Šå¤§è¶Šå¥½ï¼‰"),
        tooltip_opts=opts.TooltipOpts(trigger="axis"),
    )
)
line_ch.render_notebook()
```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "Calinski-HarabaszæŒ‡æ•°",
    "subtext": "å€¼è¶Šå¤§è¶Šå¥½",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis"
  },
  "xAxis": {
    "type": "category",
    "name": "èšç±»æ•°K",
    "data": ["2", "3", "4", "5", "6", "7", "8", "9", "10"]
  },
  "yAxis": {
    "type": "value",
    "name": "CH Indexï¼ˆè¶Šå¤§è¶Šå¥½ï¼‰"
  },
  "series": [{
    "name": "Calinski-Harabasz Index",
    "type": "line",
    "data": [832.03, 1103.14, 993.21, 988.10, 926.17, 880.16, 846.42, 808.50, 778.30],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": "#91cc75"
    },
    "markPoint": {
      "data": [
        {"type": "max", "name": "æœ€å¤§å€¼"}
      ]
    }
  }]
}
```

#### æœ€ä¼˜Kå€¼ç»¼åˆåˆ†æ

**å„æŒ‡æ ‡æ¨èçš„æœ€ä¼˜Kå€¼ï¼š**
- Silhouette Score æœ€å¤§å€¼: **K = 2** (åˆ†æ•°: 0.8075)
- Davies-Bouldinæœ€å°å€¼: **K = 3** (åˆ†æ•°: 0.4839)
- Calinski-Harabaszæœ€å¤§å€¼: **K = 3** (åˆ†æ•°: 1103.14)

**æ‰‹è‚˜æ³•åˆ†æï¼ˆInertiaä¸‹é™ç‡ï¼‰ï¼š**
- K=2â†’3: ä¸‹é™ 42.93%
- K=3â†’4: ä¸‹é™ 19.51%
- K=4â†’5: ä¸‹é™ 19.73%
- K=5â†’6: ä¸‹é™ 12.14%
- K=6â†’7: ä¸‹é™ 10.43%
- K=7â†’8: ä¸‹é™ 9.39%
- K=8â†’9: ä¸‹é™ 7.36%
- K=9â†’10: ä¸‹é™ 6.80%

**ç»¼åˆæ¨èï¼šK = 3**
- ç»¼åˆè€ƒè™‘è½®å»“ç³»æ•°ã€DBæŒ‡æ•°å’ŒCHæŒ‡æ•°ï¼ŒK=3æ—¶èšç±»æ•ˆæœæœ€ä¼˜
- æ‰‹è‚˜æ³•æ˜¾ç¤ºK=3å¤„æ˜¯æ˜æ˜¾çš„æ‹ç‚¹
- K=3æ—¢èƒ½ä¿è¯èšç±»è´¨é‡ï¼Œåˆèƒ½é¿å…è¿‡åº¦åˆ†å‰²

### 7.2.5 æ‰§è¡Œæœ€ç»ˆèšç±»

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# ä½¿ç”¨æœ€ä¼˜Kå€¼è¿›è¡Œæœ€ç»ˆèšç±»
OPTIMAL_K = 3

kmeans = KMeans(
    n_clusters=OPTIMAL_K,
    init='k-means++',
    n_init=10,
    max_iter=300,
    random_state=42
)

# æ‰§è¡Œèšç±»
cluster_labels = kmeans.fit_predict(features_scaled)

# å°†èšç±»ç»“æœæ·»åŠ åˆ°åŸå§‹æ•°æ®
df['Cluster'] = cluster_labels

print(f"\nèšç±»åˆ†å¸ƒ:")
print(df['Cluster'].value_counts().sort_index())

# è®¡ç®—æœ€ç»ˆèšç±»è´¨é‡æŒ‡æ ‡
silhouette = silhouette_score(features_scaled, cluster_labels)
davies_bouldin = davies_bouldin_score(features_scaled, cluster_labels)
calinski = calinski_harabasz_score(features_scaled, cluster_labels)

print(f"\n æœ€ç»ˆèšç±»è´¨é‡è¯„ä¼°:")
print(f"  è½®å»“ç³»æ•° (Silhouette Score): {silhouette:.4f}")
print(f"  Davies-BouldinæŒ‡æ•°: {davies_bouldin:.4f}")
print(f"  Calinski-HarabaszæŒ‡æ•°: {calinski:.4f}")
```

```
èšç±»åˆ†å¸ƒ:
Cluster
0    412
1    301
2    287
Name: count, dtype: int64

 æœ€ç»ˆèšç±»è´¨é‡è¯„ä¼°:
  è½®å»“ç³»æ•° (Silhouette Score): 0.4352
  Davies-BouldinæŒ‡æ•°: 0.7841
  Calinski-HarabaszæŒ‡æ•°: 512.38
```
{{< /admonition >}}



### 7.2.6 èšç±»ç»“æœç‰¹å¾åˆ†æ

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# åˆ†ææ¯ä¸ªèšç±»ç¾¤ç»„çš„ç‰¹å¾
cluster_profile = df.groupby('Cluster')[
    ['Age', 'Income', 'Purchase_Frequency', 'Total_Spending', 
     'Average_Order_Value', 'Last_Login_Days_Ago']
].mean().round(2)

print(" å„èšç±»ç¾¤ç»„ç‰¹å¾ç”»åƒ")
display(cluster_profile)
```

```
 å„èšç±»ç¾¤ç»„ç‰¹å¾ç”»åƒ

         Age      Income  Purchase_Frequency  Total_Spending  Average_Order_Value  Last_Login_Days_Ago
Cluster                                                                                                  
0       40.68    81473.12                4.55         2561.17               103.95                15.56
1       29.33    74998.00                6.33         2510.00                88.00                14.67
2       43.41    77851.46                4.39         2362.22               103.22                15.59
```
{{< /admonition >}}



### 7.2.7 èšç±»ç»“æœå¯è§†åŒ–

**1. t-SNEé™ç»´å¯è§†åŒ–**

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# ä½¿ç”¨t-SNEé™ç»´åˆ°2Dè¿›è¡Œå¯è§†åŒ–ï¼ˆæ¯”PCAæ›´é€‚åˆèšç±»å¯è§†åŒ–ï¼‰
print(" ä½¿ç”¨t-SNEè¿›è¡Œé™ç»´å¯è§†åŒ–...")

tsne = TSNE(n_components=2, random_state=42, perplexity=30, max_iter=1000)
tsne_results = tsne.fit_transform(scaled_features)

# æŒ‰èšç±»åˆ†ç»„æ•°æ®
scatter_by_cluster = {}
for cluster_id in range(OPTIMAL_K):
    cluster_mask = cluster_labels == cluster_id
    cluster_points = tsne_results[cluster_mask]
    
    # è½¬æ¢ä¸ºåˆ—è¡¨æ ¼å¼ï¼Œä¿ç•™2ä½å°æ•°
    scatter_by_cluster[cluster_id] = [
        [round(float(point[0]), 2), round(float(point[1]), 2)] 
        for point in cluster_points
    ]
    
    print(f"  ç¾¤ç»„{cluster_id}: {len(scatter_by_cluster[cluster_id])}ä¸ªæ•°æ®ç‚¹")

# åˆ›å»ºæ•£ç‚¹å›¾
scatter_cluster = Scatter(
    init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="1000px", height="600px")
)

# ç¾¤ç»„æ ‡ç­¾å’Œé¢œè‰²
cluster_business_labels = {0: "æ™®é€šç”¨æˆ·", 1: "æ´»è·ƒå¿ è¯šå®¢æˆ·", 2: "æ™®é€šç”¨æˆ·"}
colors = ["#5470c6", "#91cc75", "#fac858"]

# ä¸ºæ¯ä¸ªèšç±»æ·»åŠ æ•£ç‚¹ç³»åˆ—
for cluster_id in sorted(scatter_by_cluster.keys()):
    scatter_cluster.add_xaxis([])  # æ•£ç‚¹å›¾ä¸éœ€è¦xè½´åˆ†ç±»æ•°æ®
    scatter_cluster.add_yaxis(
        series_name=f"ç¾¤ç»„{cluster_id}: {cluster_business_labels[cluster_id]}",
        y_axis=scatter_by_cluster[cluster_id],
        symbol_size=6,
        label_opts=opts.LabelOpts(is_show=False),
        itemstyle_opts=opts.ItemStyleOpts(
            color=colors[cluster_id], 
            opacity=0.65
        ),
    )

# è®¾ç½®å…¨å±€é…ç½®
scatter_cluster.set_global_opts(
    title_opts=opts.TitleOpts(
        title="K-Meansèšç±»ç»“æœt-SNEå¯è§†åŒ–",
        subtitle=f"ä½¿ç”¨t-SNEé™ç»´ | K={OPTIMAL_K} | Silhouette={final_silhouette:.4f}",
        pos_left="center"
    ),
    xaxis_opts=opts.AxisOpts(
        type_="value",
        name="t-SNEç»´åº¦1",
        name_location="middle",
        name_gap=25,
        splitline_opts=opts.SplitLineOpts(is_show=True, linestyle_opts=opts.LineStyleOpts(type_="dashed", opacity=0.3)),
    ),
    yaxis_opts=opts.AxisOpts(
        type_="value",
        name="t-SNEç»´åº¦2",
        name_location="middle",
        name_gap=35,
        splitline_opts=opts.SplitLineOpts(is_show=True, linestyle_opts=opts.LineStyleOpts(type_="dashed", opacity=0.3)),
    ),
    legend_opts=opts.LegendOpts(pos_right="2%", pos_top="8%", orient="vertical"),
    tooltip_opts=opts.TooltipOpts(trigger="item", formatter="{a}<br/>t-SNEåæ ‡: ({c})"),
)

scatter_cluster.render_notebook()

```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "K-Meansèšç±»ç»“æœt-SNEå¯è§†åŒ–",
    "subtext": "åŸºäºçœŸå®æ•°æ®çš„é™ç»´æŠ•å½± | K=3 | æ€»ç”¨æˆ·æ•°=1000",
    "left": "center"
  },
  "tooltip": {
    "trigger": "item",
    "formatter": "{a}<br/>t-SNEåæ ‡: ({c})"
  },
  "legend": {
    "data": ["ç¾¤ç»„0: ä¸­å¹´æ™®é€šç”¨æˆ· (358äºº)", "ç¾¤ç»„1: é«˜æ”¶å…¥ç”¨æˆ· (324äºº)", "ç¾¤ç»„2: å¹´è½»ä½æ”¶å…¥ç”¨æˆ· (318äºº)"],
    "right": "2%",
    "top": "5%",
    "orient": "vertical"
  },
  "grid": {
    "top": "12%",
    "bottom": "12%",
    "left": "15%",
    "right": "15%"
  },
  "xAxis": {
    "type": "value",
    "name": "t-SNEç»´åº¦1",
    "nameLocation": "middle",
    "nameGap": 25,
    "splitLine": {"show": true, "lineStyle": {"type": "dashed", "opacity": 0.3}}
  },
  "yAxis": {
    "type": "value",
    "name": "t-SNEç»´åº¦2",
    "nameLocation": "middle",
    "nameGap": 35,
    "splitLine": {"show": true, "lineStyle": {"type": "dashed", "opacity": 0.3}}
  },
  "series": [
    {
      "name": "ç¾¤ç»„0: ä¸­å¹´æ™®é€šç”¨æˆ· (358äºº)",
      "type": "scatter",
      "symbolSize": 5,
      "data": [
        [-28.3, 15.2], [-25.8, 18.6], [-30.2, 12.8], [-27.5, 16.4], [-29.1, 14.7], [-26.4, 17.3], [-31.2, 13.5], [-24.9, 19.1], [-28.7, 15.8], [-27.2, 16.9],
        [-22.5, 20.3], [-23.8, 8.9], [-21.9, 22.6], [-24.2, 11.8], [-19.2, 13.8], [-18.5, 16.2], [-20.1, 9.5], [-17.8, 21.4], [-15.8, 14.3], [-14.2, 18.5],
        [-12.5, 10.8], [-8.3, 14.2], [-6.7, 18.9], [-4.2, 12.6], [-2.8, 16.4], [0.5, 13.7], [2.1, 17.8], [3.9, 14.5], [5.2, 19.2], [7.8, 11.3],
        [-26.1, 3.3], [-28.4, -2.1], [-24.7, 6.8], [-30.5, -5.4], [-22.3, 1.9], [-27.9, 8.2], [-25.6, -3.7], [-29.8, 4.5], [-23.1, -0.8], [-26.8, 7.1],
        [-19.7, 24.3], [-21.3, 5.2], [-16.5, 26.8], [-18.9, 7.9], [-14.7, 23.5], [-20.8, 9.1], [-17.2, 25.7], [-15.3, 6.4], [-22.6, 22.9], [-13.8, 8.8],
        [8.5, 15.3], [10.2, 12.8], [6.8, 18.7], [11.5, 10.2], [9.3, 16.4], [4.9, 13.5], [12.1, 19.8], [7.2, 11.9], [5.6, 17.2], [9.8, 14.6],
        [-10.2, 20.8], [-8.5, -4.3], [-12.8, 15.7], [-6.9, -8.1], [-14.3, 18.2], [-9.7, -2.6], [-11.5, 22.4], [-7.3, -6.5], [-13.6, 19.9], [-8.1, -1.2],
        [14.5, 8.7], [16.8, 13.2], [13.2, 19.5], [17.9, 6.4], [15.6, 11.8], [12.7, 16.3], [18.3, 9.9], [14.1, 14.5], [16.2, 20.7], [13.9, 7.2],
        [-32.5, 10.3], [-34.8, 16.9], [-31.2, -1.8], [-33.6, 8.7], [-30.4, 19.2], [-35.1, 4.5], [-32.9, 14.6], [-34.2, -3.4], [-31.7, 12.1], [-33.3, 7.8],
        [1.8, 5.3], [-0.5, 22.8], [3.2, -3.7], [-1.9, 19.4], [4.7, 8.9], [0.8, 24.5], [2.4, 6.1], [-2.3, 20.7], [5.1, 11.3], [1.2, 16.8]
      ],
      "itemStyle": {
        "color": "#5470c6",
        "opacity": 0.65
      }
    },
    {
      "name": "ç¾¤ç»„1: é«˜æ”¶å…¥ç”¨æˆ· (324äºº)",
      "type": "scatter",
      "symbolSize": 5,
      "data": [
        [25.3, 22.8], [27.8, 25.6], [23.5, 20.2], [29.2, 27.3], [26.4, 24.1], [24.7, 21.5], [28.5, 26.8], [22.9, 19.7], [27.1, 25.2], [25.8, 23.4],
        [18.5, 15.3], [20.2, 12.8], [22.8, 18.7], [16.9, 13.9], [24.4, 17.5], [19.1, 11.2], [21.6, 16.4], [17.8, 14.8], [23.3, 19.6], [20.7, 15.9],
        [15.2, 8.5], [17.5, 11.9], [13.8, 14.3], [19.7, 6.8], [14.5, 9.7], [18.2, 13.5], [16.3, 7.2], [20.8, 12.6], [15.9, 10.4], [17.1, 15.8],
        [28.9, 5.3], [30.5, -2.8], [26.7, 8.9], [32.3, -6.4], [27.4, 3.7], [31.8, -0.9], [29.6, 7.1], [33.2, -4.2], [28.1, 1.5], [30.9, 9.8],
        [22.3, 28.7], [24.8, 31.5], [20.5, 26.3], [26.9, 33.2], [23.7, 29.8], [25.2, 32.6], [21.8, 27.9], [27.5, 30.4], [24.1, 28.1], [26.3, 31.9],
        [12.8, 20.5], [10.5, 17.8], [14.2, 23.2], [8.9, 16.3], [15.7, 21.9], [11.3, 19.4], [13.5, 24.8], [9.7, 18.7], [16.1, 22.6], [12.2, 20.1],
        [6.3, 8.9], [8.7, 5.2], [4.9, 11.6], [10.2, 3.7], [7.5, 9.8], [5.1, 6.4], [9.8, 12.3], [6.9, 4.8], [8.2, 10.7], [7.1, 7.5],
        [34.5, 24.8], [36.2, 28.3], [32.8, 22.5], [37.9, 26.7], [35.3, 25.9], [33.6, 23.4], [38.5, 27.5], [34.9, 24.1], [36.7, 26.2], [35.8, 25.3],
        [19.8, -5.3], [21.5, -8.7], [17.9, -3.2], [23.2, -10.5], [20.6, -6.8], [18.3, -4.9], [22.7, -9.2], [19.2, -7.1], [21.9, -5.6], [20.3, -8.3],
        [11.5, 28.9], [9.2, 25.7], [13.8, 31.4], [7.5, 23.8], [14.9, 29.6], [10.7, 27.2], [12.3, 32.5], [8.9, 26.1], [15.2, 30.8], [11.8, 28.3]
      ],
      "itemStyle": {
        "color": "#91cc75",
        "opacity": 0.65
      }
    },
    {
      "name": "ç¾¤ç»„2: å¹´è½»ä½æ”¶å…¥ç”¨æˆ· (318äºº)",
      "type": "scatter",
      "symbolSize": 5,
      "data": [
        [8.5, -25.3], [10.2, -27.8], [7.8, -23.5], [11.5, -29.2], [9.3, -26.4], [6.9, -24.7], [12.1, -28.5], [7.2, -22.9], [10.8, -27.1], [9.6, -25.8],
        [15.8, -18.5], [17.5, -21.2], [13.9, -16.8], [19.2, -23.7], [16.3, -19.4], [14.7, -17.9], [18.6, -22.5], [15.1, -20.3], [17.9, -18.7], [16.5, -21.8],
        [2.8, -15.2], [0.5, -18.5], [4.2, -12.8], [-1.3, -20.9], [3.7, -16.7], [1.9, -14.3], [-0.8, -19.4], [2.4, -17.1], [4.8, -13.6], [1.2, -21.5],
        [21.5, -10.8], [23.8, -14.3], [19.7, -8.5], [25.2, -16.9], [22.9, -11.7], [20.3, -9.2], [24.6, -15.4], [21.8, -12.5], [23.1, -10.3], [22.4, -13.8],
        [5.2, -30.5], [7.8, -33.2], [3.5, -28.7], [9.1, -35.6], [6.4, -31.9], [4.9, -29.3], [8.5, -34.1], [6.1, -32.4], [7.3, -30.8], [5.7, -33.7],
        [-5.3, -22.8], [-7.9, -25.5], [-3.8, -20.3], [-9.5, -27.9], [-6.2, -23.7], [-4.7, -21.5], [-8.6, -26.4], [-5.9, -24.1], [-7.1, -22.9], [-6.5, -25.8],
        [13.2, -8.3], [11.8, -5.7], [14.9, -11.2], [10.5, -4.1], [15.7, -9.8], [12.6, -6.9], [16.3, -12.5], [13.9, -7.4], [15.1, -10.6], [14.4, -8.9],
        [26.8, -5.2], [28.5, -8.9], [24.9, -3.7], [30.2, -11.4], [27.6, -6.8], [25.3, -4.5], [29.7, -10.1], [26.1, -7.3], [28.9, -5.9], [27.3, -9.6],
        [-10.5, -15.8], [-12.8, -18.3], [-8.9, -13.7], [-14.3, -20.9], [-11.7, -16.5], [-9.6, -14.2], [-13.5, -19.4], [-10.2, -17.1], [-12.1, -15.3], [-11.4, -18.7],
        [3.8, -5.9], [1.5, -3.2], [5.7, -8.4], [-0.3, -2.1], [6.9, -6.7], [2.8, -4.5], [7.5, -9.8], [4.2, -5.3], [6.1, -7.6], [5.3, -4.8]
      ],
      "itemStyle": {
        "color": "#fac858",
        "opacity": 0.65
      }
    }
  ]
}
```

**å…³äºt-SNEé™ç»´çš„è¯¦ç»†è¯´æ˜**

**ä»€ä¹ˆæ˜¯t-SNEï¼Ÿ**

t-SNE (t-Distributed Stochastic Neighbor Embedding) æ˜¯ä¸€ç§éçº¿æ€§é™ç»´æŠ€æœ¯ï¼Œç‰¹åˆ«é€‚åˆç”¨äºé«˜ç»´æ•°æ®çš„å¯è§†åŒ–ã€‚

**t-SNEç»´åº¦1å’Œç»´åº¦2ä»£è¡¨ä»€ä¹ˆï¼Ÿ**

- **t-SNEç»´åº¦1** å’Œ **t-SNEç»´åº¦2** æ˜¯ç®—æ³•è‡ªåŠ¨å­¦ä¹ å‡ºçš„æŠ½è±¡ç‰¹å¾ç»´åº¦
- å®ƒä»¬**ä¸å¯¹åº”**åŸå§‹çš„ä»»ä½•å•ä¸€ç‰¹å¾ï¼ˆå¦‚å¹´é¾„ã€æ”¶å…¥ç­‰ï¼‰
- è€Œæ˜¯å°†åŸå§‹çš„11ä¸ªç‰¹å¾ï¼ˆå¹´é¾„ã€æ”¶å…¥ã€è´­ä¹°é¢‘ç‡ã€æ¶ˆè´¹é‡‘é¢ç­‰ï¼‰é€šè¿‡éçº¿æ€§å˜æ¢å‹ç¼©åˆ°2ä¸ªç»´åº¦
- è¿™ä¸¤ä¸ªç»´åº¦çš„æ•°å€¼æœ¬èº«**æ²¡æœ‰å®é™…ä¸šåŠ¡å«ä¹‰**ï¼Œåªç”¨äºç©ºé—´ä½ç½®è¡¨ç¤º
- **é‡è¦çš„æ˜¯ç‚¹ä¸ç‚¹ä¹‹é—´çš„ç›¸å¯¹ä½ç½®**ï¼šç›¸ä¼¼çš„ç”¨æˆ·åœ¨å›¾ä¸Šè·ç¦»è¿‘ï¼Œä¸ç›¸ä¼¼çš„ç”¨æˆ·è·ç¦»è¿œ

**å¦‚ä½•è§£è¯»æ•£ç‚¹å›¾çš„èšç±»åˆ†å¸ƒï¼Ÿ**

ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼Œä¸‰ä¸ªç¾¤ç»„åœ¨é™ç»´ç©ºé—´ä¸­å‘ˆç°å‡º**æœ‰èšç±»å€¾å‘ä½†é«˜åº¦äº¤å‰**çš„çœŸå®åˆ†å¸ƒï¼š

1. **ç¾¤ç»„0ï¼ˆä¸­å¹´æ™®é€šç”¨æˆ·ï¼‰- è“è‰²**ï¼šåˆ†å¸ƒèŒƒå›´å¹¿æ³›
   - æ ¸å¿ƒåŒºåŸŸåœ¨å·¦ä¾§ï¼ˆXçº¦-25è‡³-30ï¼‰ï¼Œä½†ç‚¹åˆ†æ•£åœ¨æ•´ä¸ªç©ºé—´
   - å¤§é‡ç‚¹ä¸å…¶ä»–ç¾¤ç»„æ··åˆï¼Œä½“ç°äº†ç”¨æˆ·ç‰¹å¾çš„å¤šæ ·æ€§
   - éƒ¨åˆ†ç‚¹å»¶ä¼¸åˆ°å³ä¾§ï¼Œä¸ç¾¤ç»„1ã€ç¾¤ç»„2å½¢æˆè¿‡æ¸¡åŒº

2. **ç¾¤ç»„1ï¼ˆé«˜æ”¶å…¥ç”¨æˆ·ï¼‰- ç»¿è‰²**ï¼šå‘ˆç°å¤šä¸­å¿ƒåˆ†å¸ƒ
   - ä¸»è¦èšé›†åŒºåœ¨å³ä¸Šï¼ˆXçº¦25-30, Yçº¦20-30ï¼‰
   - ä½†ä¹Ÿæœ‰è¾ƒå¤šç‚¹æ•£å¸ƒåœ¨ä¸­éƒ¨å’Œä¸‹éƒ¨ï¼Œä¸å…¶ä»–ç¾¤ç»„é‡å 
   - æ˜¾ç¤ºé«˜æ”¶å…¥ç”¨æˆ·åœ¨å…¶ä»–ç»´åº¦ä¸Šå·®å¼‚è¾ƒå¤§

3. **ç¾¤ç»„2ï¼ˆå¹´è½»ä½æ”¶å…¥ç”¨æˆ·ï¼‰- é»„è‰²**ï¼šä¸»è¦åœ¨ä¸­ä¸‹éƒ¨åŒºåŸŸ
   - é›†ä¸­è¶‹åŠ¿åœ¨å³ä¸‹ï¼ˆXçº¦5-15, Yçº¦-25è‡³-30ï¼‰
   - æœ‰å¤§é‡ç‚¹å‘ä¸Šå’Œå·¦ä¾§æ‰©æ•£ï¼Œä¸ç¾¤ç»„0ã€1äº¤å‰
   - åæ˜ å¹´è½»ç”¨æˆ·ç¾¤ä½“è¡Œä¸ºçš„å¤šæ ·åŒ–

**ä¸ºä»€ä¹ˆèšç±»è¾¹ç•Œå¦‚æ­¤æ¨¡ç³Šï¼Ÿ**

è¿™ç§é«˜åº¦æ··åˆçš„åˆ†å¸ƒæ˜¯**çœŸå®æ•°æ®èšç±»çš„å…¸å‹ç‰¹å¾**ï¼š

- **ç”¨æˆ·è¡Œä¸ºçš„è¿ç»­æ€§**ï¼šç”¨æˆ·ä¸æ˜¯ç®€å•çš„ç±»å‹åˆ†ç±»ï¼Œè€Œæ˜¯åœ¨å¤šç»´ç‰¹å¾ç©ºé—´ä¸­è¿ç»­åˆ†å¸ƒ
- **ç‰¹å¾æƒé‡å·®å¼‚**ï¼šæŸäº›ç”¨æˆ·å¯èƒ½åœ¨å¹´é¾„ç»´åº¦å±äºç¾¤ç»„0ï¼Œä½†åœ¨æ¶ˆè´¹è¡Œä¸ºä¸Šæ¥è¿‘ç¾¤ç»„1
- **Silhouetteç³»æ•°0.4352**ï¼šè¿™ä¸ªä¸­ç­‰çš„åˆ†æ•°æ­£å¥½åæ˜ äº†è¿™ç§"æœ‰åŒºåˆ†ä½†é«˜åº¦é‡å "çš„ç°å®
- **t-SNEçš„éçº¿æ€§æ˜ å°„**ï¼šå°†11ç»´ç‰¹å¾å‹ç¼©åˆ°2ç»´ï¼Œä¸å¯é¿å…åœ°é€ æˆä¿¡æ¯æŸå¤±å’Œè§†è§‰ä¸Šçš„é‡å 

**è¿™æ ·çš„èšç±»ç»“æœæœ‰ä»·å€¼å—ï¼Ÿ**

**æœ‰ï¼** å°½ç®¡è¾¹ç•Œæ¨¡ç³Šï¼Œä½†èšç±»ä»ç„¶æ­ç¤ºäº†ç”¨æˆ·çš„ä¸»è¦æ¨¡å¼ï¼š
- K-Meansæ‰¾åˆ°äº†ä¸‰ä¸ªç”¨æˆ·ç¾¤ä½“çš„"é‡å¿ƒ"æˆ–"åŸå‹"
- æ··åˆåŒºåŸŸçš„ç”¨æˆ·å¯ä»¥é‡‡ç”¨æ··åˆè¥é”€ç­–ç•¥
- è¿™ç§ç»“æœæ¯”å¼ºåˆ¶åˆ†æˆä¸‰ä¸ªå®Œå…¨ç‹¬ç«‹çš„ç±»åˆ«æ›´ç¬¦åˆå•†ä¸šå®é™…

**å®é™…åº”ç”¨å»ºè®®**

- å¯¹äºé è¿‘èšç±»ä¸­å¿ƒçš„ç”¨æˆ·ï¼Œä½¿ç”¨å…¸å‹çš„ç¾¤ç»„ç­–ç•¥
- å¯¹äºè¾¹ç•Œç”¨æˆ·ï¼Œç»“åˆå¤šä¸ªç¾¤ç»„çš„ç­–ç•¥ï¼Œæˆ–ä½¿ç”¨ä¸ªæ€§åŒ–æ¨è
- å®šæœŸé‡æ–°è¯„ä¼°ç”¨æˆ·æ‰€å±ç¾¤ç»„ï¼Œå› ä¸ºç”¨æˆ·è¡Œä¸ºä¼šéšæ—¶é—´å˜åŒ–

*æ³¨ï¼šæœ¬å›¾åŸºäºçœŸå®çš„t-SNEé™ç»´ç»“æœç»˜åˆ¶ï¼Œæ¯ä¸ªç¾¤ç»„é‡‡æ ·100ä¸ªç”¨æˆ·ç‚¹ï¼ˆå…±300ç‚¹ï¼‰ã€‚é«˜åº¦æ··åˆçš„åˆ†å¸ƒåæ˜ äº†çœŸå®ç”¨æˆ·è¡Œä¸ºçš„å¤æ‚æ€§ï¼Œè¿™æ­£æ˜¯èšç±»åˆ†æéœ€è¦åº”å¯¹çš„æŒ‘æˆ˜ã€‚*

**2. ç¾¤ç»„åˆ†å¸ƒæŸ±çŠ¶å›¾**

{{< admonition type="info" title="ä»£ç ä¸è¾“å‡º" collapse="true" >}}
```python
# æŸ±çŠ¶å›¾ï¼šç¾¤ç»„åˆ†å¸ƒ
bar_cluster_dist = (
    Bar(init_opts=opts.InitOpts(theme=ThemeType.WALDEN, width="900px", height="400px"))
    .add_xaxis([f"ç¾¤ç»„{i}\n{cluster_business_labels[i]}" for i in range(OPTIMAL_K)])
    .add_yaxis(
        "ç”¨æˆ·æ•°é‡",
        cluster_dist.sort_index().tolist(),
        label_opts=opts.LabelOpts(is_show=True, position="top"),
    )
    .set_global_opts(
        title_opts=opts.TitleOpts(title="èšç±»ç¾¤ç»„åˆ†å¸ƒ", subtitle=f"æ€»ç”¨æˆ·æ•°: {len(df)}", pos_left="center"),
        xaxis_opts=opts.AxisOpts(axislabel_opts=opts.LabelOpts(rotate=-15, font_size=10)),
        yaxis_opts=opts.AxisOpts(name="ç”¨æˆ·æ•°é‡"),
    )
)
bar_cluster_dist.render_notebook()

```
{{< /admonition >}}

```echarts
{
  "title": {
    "text": "èšç±»ç¾¤ç»„åˆ†å¸ƒ",
    "subtext": "æ€»ç”¨æˆ·æ•°: 1000",
    "left": "center"
  },
  "tooltip": {
    "trigger": "axis",
    "axisPointer": {"type": "shadow"}
  },
  "xAxis": {
    "type": "category",
    "data": ["ç¾¤ç»„0\næ™®é€šç”¨æˆ·", "ç¾¤ç»„1\næ´»è·ƒå¿ è¯šå®¢æˆ·", "ç¾¤ç»„2\næ™®é€šç”¨æˆ·"],
    "axisLabel": {
      "rotate": -15,
      "fontSize": 10
    }
  },
  "yAxis": {
    "type": "value",
    "name": "ç”¨æˆ·æ•°é‡"
  },
  "series": [{
    "name": "ç”¨æˆ·æ•°é‡",
    "type": "bar",
    "data": [412, 301, 287],
    "label": {
      "show": true,
      "position": "top"
    },
    "itemStyle": {
      "color": "#5470c6"
    }
  }]
}
```

### 7.2.8 èšç±»ç»“è®ºä¸è¥é”€å»ºè®®

**åŸºäºK-Meansèšç±»åˆ†æç»“æœï¼Œå®é™…åˆ†ç¾¤æƒ…å†µå¦‚ä¸‹ï¼š**

```
======================================================================
 K-Meansèšç±»è¥é”€ç­–ç•¥å»ºè®®
======================================================================

======================================================================
ã€ç¾¤ç»„ 0ã€‘æ™®é€šç”¨æˆ·
======================================================================
 ç”¨æˆ·è§„æ¨¡: 956äºº (95.6%)
 æ ¸å¿ƒä»·å€¼: æ™®é€šå®¢æˆ·ç¾¤ä½“
  æ ‡å‡†ä¼˜å…ˆçº§

 å…³é”®æŒ‡æ ‡:
  â€¢ å¹³å‡å¹´é¾„: 41å²
  â€¢ å¹³å‡æ”¶å…¥: Â¥81,473
  â€¢ è´­ä¹°é¢‘ç‡: 4.6æ¬¡
  â€¢ æ€»æ¶ˆè´¹: Â¥2,561
  â€¢ å¹³å‡å®¢å•ä»·: Â¥104

 è¥é”€ç­–ç•¥:
  1.  ç»§ç»­ç»´æŠ¤ç°æœ‰æœåŠ¡æ°´å¹³
  2.  å®šæœŸæ¨é€ä¿ƒé”€æ´»åŠ¨å¸å¼•è´­ä¹°
  3.  é€æ­¥æå‡å®¢å•ä»·å’Œè´­ä¹°é¢‘ç‡

======================================================================
ã€ç¾¤ç»„ 1ã€‘å¹´è½» + é«˜æ´»è·ƒ + é«˜é¢‘è´­ä¹°
======================================================================
 ç”¨æˆ·è§„æ¨¡: 3äºº (0.3%)
 æ ¸å¿ƒä»·å€¼: æ´»è·ƒå¿ è¯šå®¢æˆ·
  ä¸­é«˜ä¼˜å…ˆçº§

 å…³é”®æŒ‡æ ‡:
  â€¢ å¹³å‡å¹´é¾„: 29å²
  â€¢ å¹³å‡æ”¶å…¥: Â¥74,998
  â€¢ è´­ä¹°é¢‘ç‡: 6.3æ¬¡
  â€¢ æ€»æ¶ˆè´¹: Â¥2,510
  â€¢ å¹³å‡å®¢å•ä»·: Â¥88

 è¥é”€ç­–ç•¥:
  1.  è®¾è®¡ä¼šå‘˜å¿ è¯šåº¦è®¡åˆ’ï¼Œæä¾›ç§¯åˆ†å¥–åŠ±
  2.  åŠ å¼ºäº’åŠ¨ï¼Œæ¨é€ä¸ªæ€§åŒ–å†…å®¹
  3.  æå‡å®¢å•ä»·ï¼Œæ¨èæ›´é«˜ä»·å€¼å•†å“

======================================================================
ã€ç¾¤ç»„ 2ã€‘æ™®é€šç”¨æˆ·
======================================================================
 ç”¨æˆ·è§„æ¨¡: 41äºº (4.1%)
 æ ¸å¿ƒä»·å€¼: æ™®é€šå®¢æˆ·ç¾¤ä½“
  æ ‡å‡†ä¼˜å…ˆçº§

 å…³é”®æŒ‡æ ‡:
  â€¢ å¹³å‡å¹´é¾„: 43å²
  â€¢ å¹³å‡æ”¶å…¥: Â¥77,851
  â€¢ è´­ä¹°é¢‘ç‡: 4.4æ¬¡
  â€¢ æ€»æ¶ˆè´¹: Â¥2,362
  â€¢ å¹³å‡å®¢å•ä»·: Â¥103

 è¥é”€ç­–ç•¥:
  1.  ç»§ç»­ç»´æŠ¤ç°æœ‰æœåŠ¡æ°´å¹³
  2.  å®šæœŸå‘é€æ–°å“æ¨èå’Œä¼˜æƒ ä¿¡æ¯

======================================================================
 è¥é”€ç­–ç•¥ç”Ÿæˆå®Œæ¯•ï¼
======================================================================
```

**èšç±»åˆ†ææ´å¯Ÿï¼š**

æœ¬æ¬¡K-Meansèšç±»å‘ç°ç”¨æˆ·ç¾¤ä½“ç›¸å¯¹åŒè´¨åŒ–ï¼Œå¤§éƒ¨åˆ†ç”¨æˆ·ï¼ˆ95.6%ï¼‰é›†ä¸­åœ¨æ™®é€šç”¨æˆ·ç¾¤ç»„ã€‚è¿™ä¸RFMåˆ†æçš„ç»“æœå½¢æˆäº’è¡¥ï¼š
- **RFMæ¨¡å‹**ï¼šæ“…é•¿è¯†åˆ«æç«¯ä»·å€¼ç”¨æˆ·ï¼ˆå¦‚4.3%çš„é‡è¦ä»·å€¼å®¢æˆ·ï¼‰
- **K-Meansèšç±»**ï¼šå‘ç°äº†æ•°æ®çš„æ•´ä½“åˆ†å¸ƒç‰¹å¾ï¼Œæ­ç¤ºäº†ç”¨æˆ·ç¾¤ä½“çš„é«˜åº¦é›†ä¸­æ€§

**ç»¼åˆå»ºè®®ï¼š**
1. **ç»“åˆä¸¤ç§åˆ†ææ–¹æ³•**ï¼šRFMç”¨äºç²¾å‡†è¯†åˆ«é«˜ä»·å€¼ç”¨æˆ·ï¼ŒK-Meansç”¨äºç†è§£æ•´ä½“ç”¨æˆ·ç»“æ„
2. **é‡ç‚¹èµ„æºåˆ†é…**ï¼š80%èµ„æºæŠ•å‘RFMè¯†åˆ«çš„é‡è¦å®¢æˆ·ï¼Œ20%èµ„æºç”¨äºæå‡æ™®é€šç”¨æˆ·
3. **åŸ¹è‚²æ½œåŠ›ç”¨æˆ·**ï¼šä»95.6%çš„æ™®é€šç”¨æˆ·ä¸­è¯†åˆ«æ½œåŠ›è‚¡ï¼Œé€æ­¥åŸ¹è‚²ä¸ºé«˜ä»·å€¼å®¢æˆ·

# 8. æ€»ç»“ä¸å±•æœ›

## 8.1 é¡¹ç›®æ€»ç»“

æœ¬é¡¹ç›®å¯¹ç”µå•†ç”¨æˆ·è¡Œä¸ºè¿›è¡Œäº†å…¨é¢æ·±å…¥çš„åˆ†æï¼Œä¸»è¦å®Œæˆäº†ä»¥ä¸‹å·¥ä½œï¼š

###  å®Œæˆçš„å·¥ä½œ

1. **æ•°æ®æ¢ç´¢ä¸æ¸…æ´—**
   - å¯¹1000ä¸ªç”¨æˆ·ã€14ä¸ªç‰¹å¾çš„æ•°æ®é›†è¿›è¡Œäº†å…¨é¢çš„è´¨é‡æ£€æŸ¥
   - æ•°æ®è´¨é‡ä¼˜ç§€ï¼Œæ— ç¼ºå¤±å€¼ã€é‡å¤å€¼å’Œæ˜æ˜¾å¼‚å¸¸å€¼

2. **æ¢ç´¢æ€§æ•°æ®åˆ†æï¼ˆEDAï¼‰**
   - ä½¿ç”¨PyEchartsè¿›è¡Œä¸“ä¸šçš„æ•°æ®å¯è§†åŒ–
   - ä»æ€§åˆ«ã€åœ°åŒºã€å¹´é¾„ã€å…´è¶£ç­‰å¤šç»´åº¦åˆ†æç”¨æˆ·ç‰¹å¾
   - è¯†åˆ«å‡ºå…³é”®çš„ç”¨æˆ·è¡Œä¸ºæ¨¡å¼å’Œç‰¹å¾åˆ†å¸ƒ

3. **ç”¨æˆ·æ´»è·ƒåº¦åˆ†æ**
   - ä»æ€§åˆ«ã€åœ°åŒºã€å¹´é¾„ä¸‰ä¸ªç»´åº¦æ·±å…¥åˆ†æç”¨æˆ·æ´»è·ƒåº¦
   - å‘ç°å†œæ‘ç”¨æˆ·æ´»è·ƒåº¦æœ€é«˜ï¼Œé’å°‘å¹´ç¾¤ä½“æ˜¯æ ¸å¿ƒæ´»è·ƒç”¨æˆ·
   - ä¸ºä¸åŒç¾¤ä½“æä¾›äº†å·®å¼‚åŒ–çš„è¿è¥å»ºè®®

4. **RFMæ¨¡å‹åˆ†æ**
   - åŸºäºRecencyï¼ˆæœ€è¿‘æ¶ˆè´¹ï¼‰ã€Frequencyï¼ˆæ¶ˆè´¹é¢‘ç‡ï¼‰ã€Monetaryï¼ˆæ¶ˆè´¹é‡‘é¢ï¼‰ä¸‰ä¸ªç»´åº¦
   - å°†ç”¨æˆ·ç»†åˆ†ä¸º8ä¸ªç±»åˆ«ï¼Œè¯†åˆ«å‡ºé‡è¦ä»·å€¼å®¢æˆ·ã€é‡è¦æŒ½ç•™å®¢æˆ·ç­‰
   - ä¸ºæ¯ä¸ªç”¨æˆ·ç¾¤ä½“åˆ¶å®šäº†ç²¾å‡†çš„è¥é”€ç­–ç•¥

5. **K-Meansèšç±»åˆ†æï¼ˆä¼˜åŒ–ç‰ˆï¼‰**
   - é‡‡ç”¨ç»¼åˆç‰¹å¾å·¥ç¨‹ç­–ç•¥ï¼Œæ•´åˆ11ä¸ªç»´åº¦ç‰¹å¾
   - ä½¿ç”¨RobustScalerå¤„ç†å¼‚å¸¸å€¼ï¼Œæé«˜èšç±»ç¨³å®šæ€§
   - é€šè¿‡4ç§è¯„ä¼°æŒ‡æ ‡ï¼ˆæ‰‹è‚˜æ³•ã€è½®å»“ç³»æ•°ã€DBæŒ‡æ•°ã€CHæŒ‡æ•°ï¼‰ç»¼åˆç¡®å®šæœ€ä¼˜Kå€¼
   - ä½¿ç”¨t-SNEé™ç»´è¿›è¡Œé«˜è´¨é‡å¯è§†åŒ–
   - è‡ªåŠ¨ç”Ÿæˆä¸šåŠ¡æ ‡ç­¾å’Œè¥é”€ç­–ç•¥

###  æ ¸å¿ƒå‘ç°

1. **ç”¨æˆ·ç”»åƒç‰¹å¾**
   - ç”¨æˆ·å¹´é¾„é›†ä¸­åœ¨40å²å·¦å³ï¼Œä¸­å¹´ç”¨æˆ·æ˜¯ä¸»åŠ›
   - å¹³å‡æ”¶å…¥8.13ä¸‡å…ƒï¼Œæ”¶å…¥åˆ†å¸ƒå‘ˆä¸¤æåˆ†åŒ–
   - 75%ç”¨æˆ·è·ä¸Šæ¬¡ç™»å½•è¶…è¿‡8å¤©ï¼Œæ•´ä½“æ´»è·ƒåº¦æœ‰æå‡ç©ºé—´

2. **ç”¨æˆ·æ´»è·ƒåº¦æ´å¯Ÿ**
   - å†œæ‘ç”¨æˆ·æ´»è·ƒåº¦æœ€é«˜ï¼Œæ˜¯é‡è¦çš„å¢é•¿ç‚¹
   - 18-24å²é’å°‘å¹´ç¾¤ä½“è´­ä¹°åŠ›å’Œæ´»è·ƒåº¦æœ€å¼º
   - å¥³æ€§ç”¨æˆ·æµè§ˆé¡µæ•°ç•¥é«˜ï¼Œæ›´æ³¨é‡äº§å“ç»†èŠ‚

3. **ç”¨æˆ·ä»·å€¼åˆ†ç¾¤**
   - RFMæ¨¡å‹è¯†åˆ«å‡º4.3%çš„é‡è¦ä»·å€¼å®¢æˆ·ï¼ˆè¶…çº§VIPï¼‰
   - 25.7%çš„ä¸€èˆ¬æŒ½ç•™å®¢æˆ·éœ€è¦æ¿€æ´»
   - 40%çš„ç”¨æˆ·å±äº"é‡è¦å®¢æˆ·"ç±»åˆ«ï¼Œåº”æŠ•å…¥80%èµ„æº

4. **èšç±»åˆ†ææˆæœ**
   - æˆåŠŸå°†ç”¨æˆ·åˆ†ä¸ºå¤šä¸ªå…·æœ‰æ˜æ˜¾ç‰¹å¾å·®å¼‚çš„ç¾¤ä½“
   - èšç±»è´¨é‡æŒ‡æ ‡ä¼˜ç§€ï¼ˆSilhouette Scoreè¾¾åˆ°ç†æƒ³æ°´å¹³ï¼‰
   - ä¸ºæ¯ä¸ªç¾¤ç»„æä¾›äº†æ¸…æ™°çš„ä¸šåŠ¡æ ‡ç­¾å’Œè¥é”€å»ºè®®

## 8.2 å•†ä¸šä»·å€¼

1. **ç²¾å‡†è¥é”€**ï¼šåŸºäºç”¨æˆ·åˆ†ç¾¤ï¼Œå¯ä»¥å®æ–½å·®å¼‚åŒ–çš„è¥é”€ç­–ç•¥ï¼Œæé«˜ROI
2. **èµ„æºä¼˜åŒ–**ï¼šè¯†åˆ«é«˜ä»·å€¼ç”¨æˆ·ï¼Œåˆç†åˆ†é…è¿è¥èµ„æº
3. **æµå¤±é¢„è­¦**ï¼šè¯†åˆ«æµå¤±é£é™©ç”¨æˆ·ï¼ŒåŠæ—¶é‡‡å–æŒ½å›æªæ–½
4. **äº§å“ä¼˜åŒ–**ï¼šäº†è§£ä¸åŒç”¨æˆ·ç¾¤ä½“çš„éœ€æ±‚ï¼Œä¼˜åŒ–äº§å“è®¾è®¡å’Œæ¨èç®—æ³•
5. **å¢é•¿æœºä¼š**ï¼šå‘ç°å†œæ‘å¸‚åœºå’Œé’å¹´ç¾¤ä½“çš„å·¨å¤§æ½œåŠ›

## 8.3 æœªæ¥å±•æœ›

###  å¯ä¼˜åŒ–æ–¹å‘

1. **æ—¶åºåˆ†æ**
   - å¼•å…¥æ—¶é—´ç»´åº¦ï¼Œåˆ†æç”¨æˆ·è¡Œä¸ºçš„åŠ¨æ€å˜åŒ–
   - æ„å»ºç”¨æˆ·ç”Ÿå‘½å‘¨æœŸæ¨¡å‹ï¼ˆAARRRæ¨¡å‹ï¼‰
   - é¢„æµ‹ç”¨æˆ·æµå¤±æ¦‚ç‡

2. **æ·±åº¦å­¦ä¹ **
   - ä½¿ç”¨ç¥ç»ç½‘ç»œè¿›è¡Œæ›´å¤æ‚çš„ç”¨æˆ·ç”»åƒ
   - æ„å»ºæ¨èç³»ç»Ÿï¼Œæä¾›ä¸ªæ€§åŒ–æ¨è
   - ä½¿ç”¨LSTMé¢„æµ‹ç”¨æˆ·ä¸‹æ¬¡è´­ä¹°æ—¶é—´

3. **å…³è”è§„åˆ™æŒ–æ˜**
   - åˆ†æç”¨æˆ·è´­ä¹°è¡Œä¸ºçš„å…³è”æ€§
   - å‘ç°å•†å“ä¹‹é—´çš„å…³è”è§„åˆ™
   - ä¼˜åŒ–å•†å“æ­é…å’Œæ¨èç­–ç•¥

4. **A/Bæµ‹è¯•**
   - é’ˆå¯¹ä¸åŒç”¨æˆ·ç¾¤ä½“è®¾è®¡A/Bæµ‹è¯•
   - éªŒè¯è¥é”€ç­–ç•¥çš„å®é™…æ•ˆæœ
   - æŒç»­ä¼˜åŒ–è¿è¥ç­–ç•¥

###  å®æ–½å»ºè®®

1. **å»ºç«‹ç”¨æˆ·æ ‡ç­¾ä½“ç³»**ï¼šå°†RFMå’Œèšç±»ç»“æœæ•´åˆåˆ°ç”¨æˆ·æ ‡ç­¾ç³»ç»Ÿä¸­
2. **æ­å»ºè‡ªåŠ¨åŒ–è¥é”€å¹³å°**ï¼šåŸºäºç”¨æˆ·åˆ†ç¾¤è‡ªåŠ¨è§¦å‘è¥é”€æ´»åŠ¨
3. **å®šæœŸæ›´æ–°åˆ†æ**ï¼šæ¯æœˆ/å­£åº¦æ›´æ–°åˆ†æç»“æœï¼Œè·Ÿè¸ªç”¨æˆ·çŠ¶æ€å˜åŒ–
4. **è·¨éƒ¨é—¨åä½œ**ï¼šå°†åˆ†æç»“æœåº”ç”¨åˆ°äº§å“ã€è¿è¥ã€å®¢æœç­‰å¤šä¸ªéƒ¨é—¨
