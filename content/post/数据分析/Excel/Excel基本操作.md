---
title: "Excel基本操作"
date: 2025-03-11
categories: ["数据分析"]
tags: ["数据分析","Excel"]
summary: "Excel基本操作"
math: true
---
# 保护功能

## 工作簿保护

限制对工作簿结构的修改，包括防止增加/删除工作表、修改工作表名称、隐藏工作表等操作。

- 保护：点击 <kbd>审阅</kbd> → 点击 <kbd>保护</kbd>→ 选择 `保护工作簿` 
- 加密：点击 <kbd>文件</kbd> → 点击 <kbd>信息</kbd>→ 点击 <kbd>保护工作簿</kbd>→ 选择 `用密码进行加密` → 输入密码
- 不加密：点击 <kbd>文件</kbd> → 点击 <kbd>信息</kbd>→ 点击 <kbd>保护工作簿</kbd>→ 选择 `用密码进行加密` → 删除已有输入密码

## 保护工作表

针对工作表的保护，限制删除或增加行、列；限制单元格录入数据等。

- 保护：点击 <kbd>审阅</kbd> → 点击 <kbd>保护</kbd>→ 选择 `保护工作表` 

## 部分单元格可编辑 

先取消可编辑单元格的"锁定"，然后设置保护工作表。

- 取消锁定 ： <kbd>Ctrl</kbd> + <kbd>A</kbd> 选中所有单元格 → 打开 **设置单元格格式** → 切换到 **保护** → 取消勾选 **锁定** 选项，然后点击 **确定** 
- 选中限制部分单元格进行锁定：打开 **设置单元格格式** → 切换到 **保护** → 勾选 **锁定** 选项，然后点击 **确定** 
- 设定 **保护工作表**

# 数据输入

## 快速输入数据

### 自定义序列

win：文件→选项→高级→常规→编辑自定义列表

mac： Excel 菜单栏→偏好设置（<kbd>⌘Command</kbd>+<kbd>,</kbd>）→ 公式和列表 → 自定义序列

新建序列：

- 输入时用英文逗号分隔条目（如：e,w,q）
- 序列内容支持任意文本/字符/数字组合
- 添加后可在单元格输入首项后，通过填充柄自动填充
- 不能更改默认序列

### 填充柄

填充方法：拖动单元格右下角十字标记实现自动填充

win：开始选项卡→编辑栏→填充→序列

mac： 开始选项卡→编辑栏→填充→系列

序列类型：

- 等差序列：需先输入至少两个示例数字（如2,4）
- 等比序列：通过右键菜单设置步长和终止值
- 日期序列：支持按日/月/年/工作日填充

混合内容处理：

- 文字+数字组合时，仅数字部分递增
- 纯文字内容按自定义序列规则填充

### 不连续单元格输入相同数据（或参考选定模式）

win：按住 <kbd>Ctrl</kbd> 选择多个不连续单元格，输入内容后按 <kbd>Ctrl</kbd> + <kbd>Enter</kbd> 完成批量填充

mac：按住 <kbd>command</kbd> 选择多个不连续单元格，输入内容后按 <kbd>command</kbd> + <kbd>Enter</kbd> 完成批量填充

### 文本记忆式输入法

win：右击单元格选择 从下拉列表中选择，自动显示该列已输入过的文本内容

mac：单击单元格，按 <kbd>option</kbd> + <kbd>↓</kbd> ，自动显示该列已输入过的文本内容

### 数据验证方法（创建下拉框）

设置方法：数据→数据验证→序列

三种创建方式：

- 手动输入选项：来源数据需要英文逗号分隔（比如男, 女）
- 引用单元格区域：键入来源框后去验证数据单元格选择数据（比如=\$A\$18:\$A\$20）
- 使用命名范围：需先在公式→名称管理器→名称定义，选择验证数据单元格范围进行范围命名后，再去来源框键入命名（比如部门）

清除方法：数据验证→全部清除

### 数字编码（参考数据格式自定义）

设置方法： 单元格→设置单元格格式 → 数字 → 自定义，使用方括号定义输入值，双引号定义显示内容

性别编码示例：比如输入1显示"男"，输入0显示"女"，格式为：[=1]"男";[=0]"女"

单位显示示例：比如设置"777元/年"显示但保留数值计算功能，格式为：0"元/年"

注意事项：

- 分号必须使用英文格式
- 双引号必须使用英文格式且只需一层
- 最多只能设置**两种条件格式**
- 实际存储的仍是数字值（靠右对齐）

## 数据格式

设置方法： 单元格→设置单元格格式 → 数字（ → 自定义）

### 自定义数字格式

自定义格式允许你改变数据的**显示方式**，而**不改变**数据本身的**值**（即用于计算的值不变）

自定义格式代码最多可以包含四个部分，用分号 `;` 分隔。每一部分对应不同类型的数字：

```
[大于零的格式]; [小于零的格式]; [等于零的格式]; [文本的格式]
```

注意事项：

- 如果写一个部分：**所有数字**都使用这个格式
- 如果写两个部分：**第一部分**用于正数和零，**第二部分**用于负数

### 常用数字格式

**手机号码（3-4-4结构）**

- 格式：`000-0000-0000`
- 输入：`13812345678` → 显示：`138-1234-5678`

**金额会计格式（负数红色并带括号）**

- 格式：`#,##0.00_);[红色](#,##0.00)`
- 输入：`1234.5` → 显示：`1,234.50`
- 输入：`-1234.5` → 显示：**红色**的 `(1,234.50)`

**添加单位（不影响计算）**

- 格式：`0.00 "m/s"`
- 输入：`10.5` → 显示：`10.50 m/s`（单元格值仍是数字 10.5，可用于计算）

**将数字显示为等级**（最多只能设置两个条件）

- 格式：`[=1]"男";[=2]"女";"未知"`
- 输入：`1` → 显示：`男`
- 输入：`2` → 显示：`女`
- 输入：`3` → 显示：`未知`

**隐藏零值**

- 格式：`#,##0.00;-0.00;;`
- 第三部分为空，所以零值显示为空白

### 符号含义

| 符号         | 含义                                                        | 示例                                                         |
| :----------- | :---------------------------------------------------------- | :----------------------------------------------------------- |
| **`0`**      | **数字占位符**。显示有效数字和无意义的零。                  | 格式 `000`，数字 `5` 显示为 `005`；格式 `0.00`，数字 `1.5` 显示为 `1.50`。 |
| **`#`**      | **数字占位符**。只显示有效数字，不显示无意义的零。          | 格式 `###`，数字 `5` 显示为 `5`；格式 `#.##`，数字 `1.5` 显示为 `1.5`，`1.0` 显示为 `1`。 |
| **`?`**      | **数字占位符**。为无意义的零保留空格，以便小数点对齐。      | 格式 `0.???`，数字 `1.4` 和 `1.45` 会沿小数点对齐显示。      |
| **`.`**      | **小数点**。确定小数点的位置。                              | 格式 `0.00`，数字 `12` 显示为 `12.00`。                      |
| **`,`**      | **千位分隔符**。用于分隔大数字的千位。                      | 格式 `#,##0`，数字 `1000000` 显示为 `1,000,000`。            |
| **`@`**      | **文本占位符**。代表输入单元格中的原始文本。                | 格式 `"员工：" @`，输入“张三”显示为 `员工：张三`。           |
| **`*`**      | **重复字符**。重复下一个字符以填充列宽。                    | 格式 `0*-`，数字 `5` 显示为 `5-------------------------------` (填满单元格)。 |
| **`_`**      | **留空**。留下一个与下一个字符等宽的空格，用于对齐。        | 格式 `_($0.00_)` 会在正数后留一个与右括号等宽的空格，使正负数对齐。 |
| **`"文本"`** | **显示文本**。直接显示双引号内的文本。                      | 格式 `0.00 "公斤"`，数字 `2.5` 显示为 `2.50 公斤`。          |
| **`\字符`**  | **转义字符**。直接显示紧随其后的字符。                      | 格式 `0\.00`，数字 `3.5` 显示为 `3.50`（正常显示小数点）。   |
| **`[颜色]`** | **设置颜色**。用指定颜色显示内容。                          | 格式 `[蓝色]0;[红色]-0`，正数显示为蓝色，负数显示为红色。    |
| **`[条件]`** | **条件格式**。为数字设置自定义条件，超越标准的四部分规则。  | 格式 `[>=90]"优";[>=60]"及格";"不及格"`，数字 `95` 显示为 `优`。 |
| **`;`**      | **分隔符**。用于分隔格式代码的四个部分：正数;负数;零;文本。 | 格式 `0;-0;"零";"文本："@`                                   |

### 文本格式转数字格式

转换方法：

- 乘法运算：=A1*1

- 除法运算：=A1/1

- 加法运算：=A1+0
- 减法运算：=A1-0
- 减负运算：=--A1
- `VALUE` 函数：=VALUE(A1)

格式设置：

- 使用运算符、公式转换（如VALUE函数）
- 若转换后无变化，将单元格格式设置为"常规"
- 注意双击编辑可能导致格式恢复

## 数据规范化

### 日期规范化

常见不规范形式：（Excel 日期默认 0 值：1900/1/0）

- 点分隔：2014.1.3
- 无分隔符：20140103

处理方式：

- 编辑 → 查找和选择 → 替换 ：比如将点 `.` 替换为短斜杠 `/` （适用处理点分隔）
- `SUBSTITUTE` 函数：=SUBSTITUTE(A1, ".", "/")（适用处理点分隔，数据类型为文本，需要数值则进行转换）
- 数据 → 数据工具 → 分列：前两步保持默认，第三步选择"日期"格式（适用处理无分隔）
- `TEXT` 函数：=TEXT(A1, "##-##-##") （适用处理无分隔，数据类型为文本，需要数值则进行转换）

使用示例：

```
+----------------+----------------+----------------+
| 不规范日期      | 应用函数        | 规范日期       |
+----------------+----------------+----------------+
| 1998.8.8       | SUBSTITUTE     |                |
+----------------+----------------+----------------+
| 95.8.8         |                |                |
+----------------+----------------+----------------+
| 2014.12.12     |                |                |
+----------------+----------------+----------------+
| 20080808       | TEXT           |                |
+----------------+----------------+----------------+
| 990909         |                |                |
+----------------+----------------+----------------+
| 20140909       |                |                |
+----------------+----------------+----------------+
| 122040         |                |                |
+----------------+----------------+----------------+
| 234030         |                |                |
+----------------+----------------+----------------+
```

示例答案：

```
+----------------+-----------------------------+----------------+
| 不规范日期      | 应用函数                     | 规范日期       |
+----------------+-----------------------------+----------------+
| 1998.8.8       | =SUBSTITUTE(A2,".","/")*1   |        1998/8/8|
+----------------+-----------------------------+----------------+
| 95.8.8         | =SUBSTITUTE(A3,".","/")*1   |        1995/8/8|
+----------------+-----------------------------+----------------+
| 2014.12.12     | =SUBSTITUTE(A4,".","/")*1   |      2014/12/12|
+----------------+-----------------------------+----------------+
|        20080808| =--TEXT(A5,"####-##-##")    |      2008/08/08|
+----------------+-----------------------------+----------------+
|          990909| =--TEXT(A6,"####-##-##")    |      1999/09/09|
+----------------+-----------------------------+----------------+
|        20140909| =--TEXT(A7,"####-##-##")    |      2014/09/09|
+----------------+-----------------------------+----------------+
|          122040| =--TEXT(A8,"00!:00!:00")    |        12:20:40|
+----------------+-----------------------------+----------------+
|          234030| =--TEXT(A9,"00!:00!:00")    |        23:40:30|
+----------------+-----------------------------+----------------+
```

注意事项：

- 时间要显示`:`，必须加上强字符 `!` 或 `-`
- `*1` 是将文本时间转成数字时间的乘法运算，`--` 是将文本时间转成数字时间的减负运算（都可以）

### 字符规范化

批量删除单引号：（比如 `'sd` ，单元格显示 `sd`）

- 选中空白单元格 → 点击格式刷
- 选则目标区域

# 常用快捷键

## 数据快速求和

win：<kbd>Alt</kbd>+<kbd>=</kbd> 

mac：<kbd>⌘Command</kbd>+<kbd>Shift</kbd>+<kbd>T</kbd>

快捷键处理方式：（适用处理少量的目标单元格上方连续数据）

- 选中需要展示求和数据的目标单元格（空值）（若不连续，使用 <kbd>Ctrl</kbd> 辅助）
- 使用快捷键： <kbd>Alt</kbd>+<kbd>=</kbd> 

定位条件处理方式：（适用处理大量的目标单元格上方连续数据）

- 选择和查找→点击定位条件→选择定位空值
- 使用快捷键： <kbd>Alt</kbd>+<kbd>=</kbd> 

## 数据单元格区域选择

- 数据行：<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>→</kbd>
- 数据列：<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>↓</kbd>
- 数据多行多列：
  - 右下：<kbd>Ctrl</kbd>+<kbd>Shift</kbd>+<kbd>→</kbd>+<kbd>↓</kbd>

## 添加选定模式

win： <kbd>Shift</kbd>+<kbd>F8</kbd> 

mac：<kbd>Shift</kbd>+<kbd>Fn</kbd>+<kbd>F8</kbd>

- 按下快捷键： <kbd>Shift</kbd>+<kbd>F8</kbd> ，激活选定模式（再次按下 <kbd>Shift</kbd>+<kbd>F8</kbd> 取消）
- 工作表状态栏显示 **添加到所选内容**
- 在该模式下，只需用鼠标左键分别单击不连续的单元格或区域即可选定，无需持续按住<kbd>Ctrl</kbd>



## 其他常见快捷键



# 窗口冻结与拆分

高频使用场景：

- 大型数据表浏览
- 多列数据对比
- 数据录入校验

使用建议：数据查看完毕后及时取消冻结

冻结位置：始终是在选中不需冻结单元格的右下方位（在活动单元格的左上方位）

## 冻结首行/首列

设置方法：视图选项卡→冻结窗格→冻结首行/首列

处理方式：选中不需冻结单元格的右下方位，再点击冻结首行/首列

## 冻结指定单元格上行和左列

设置方法：视图选项卡→冻结窗格→冻结拆分窗格

处理方式：

- 定位到需要冻结区域右下方的首个活动单元格
- 执行冻结拆分窗格

# 数据透视

TODO